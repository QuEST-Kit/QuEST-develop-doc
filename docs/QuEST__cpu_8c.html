<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quantum Exact Simulation Toolkit: QuEST_cpu.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quantum Exact Simulation Toolkit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_43e0a1f539e00dcfa1a6bc4d4fee4fc2.html">home</a></li><li class="navelem"><a class="el" href="dir_12c8531bab6af2ddac76845e917825f6.html">tyson</a></li><li class="navelem"><a class="el" href="dir_a43f0790ed2b260370bb7e4599f2552f.html">Desktop</a></li><li class="navelem"><a class="el" href="dir_9c9f165d308c6559281afec56cb10bdb.html">GitHubRepos</a></li><li class="navelem"><a class="el" href="dir_69c54869d8f00b4de71b9ee2b8d81922.html">QuEST</a></li><li class="navelem"><a class="el" href="dir_8af595bbf2c9c3f01bedee6cc2eaf318.html">QuEST</a></li><li class="navelem"><a class="el" href="dir_f618f1a4b5adbc95a14b6debe56a4630.html">src</a></li><li class="navelem"><a class="el" href="dir_7a40d4fb53a9ab0f5d65a5f29ccd024d.html">CPU</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">QuEST_cpu.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The core of the CPU backend functionality.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="QuEST_8h_source.html">QuEST.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__internal_8h_source.html">QuEST_internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__precision_8h_source.html">QuEST_precision.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mt19937ar_8h_source.html">mt19937ar.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__cpu__internal_8h_source.html">QuEST_cpu_internal.h</a>&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
</div>
<p><a href="QuEST__cpu_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0abdff5f6065f9d57065345e6d90fc94"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> norm, int normFirst, long long int startAmpInd, long long int numAmps, long long int blockSize)</td></tr>
<tr class="separator:a0abdff5f6065f9d57065345e6d90fc94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab81b8b4e355597b50d7bbe264acf2efc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDiagonalOperator.html">DiagonalOperator</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab81b8b4e355597b50d7bbe264acf2efc">createDiagonalOperator</a> (int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="memdesc:ab81b8b4e355597b50d7bbe264acf2efc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a <a class="el" href="structDiagonalOperator.html" title="Represents a diagonal compelx operator on the full Hilbert state of a Qureg. ">DiagonalOperator</a> representing a diagonal operator on the full Hilbert space of a <a class="el" href="structQureg.html" title="Represents a system of qubits. ">Qureg</a>.  <a href="#ab81b8b4e355597b50d7bbe264acf2efc">More...</a><br /></td></tr>
<tr class="separator:ab81b8b4e355597b50d7bbe264acf2efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7772f97cb4d92a9825bf3b7c82c3230c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7772f97cb4d92a9825bf3b7c82c3230c">densmatr_calcFidelityLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQureg.html">Qureg</a> pureState)</td></tr>
<tr class="memdesc:a7772f97cb4d92a9825bf3b7c82c3230c"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes a few dens-columns-worth of (vec^*T) dens * vec  <a href="#a7772f97cb4d92a9825bf3b7c82c3230c">More...</a><br /></td></tr>
<tr class="separator:a7772f97cb4d92a9825bf3b7c82c3230c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939897137596bb73ad7a028d0beaaa10"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a939897137596bb73ad7a028d0beaaa10">densmatr_calcHilbertSchmidtDistanceSquaredLocal</a> (<a class="el" href="structQureg.html">Qureg</a> a, <a class="el" href="structQureg.html">Qureg</a> b)</td></tr>
<tr class="memdesc:a939897137596bb73ad7a028d0beaaa10"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes Tr((a-b) conjTrans(a-b)) = sum of abs values of (a-b)  <a href="#a939897137596bb73ad7a028d0beaaa10">More...</a><br /></td></tr>
<tr class="separator:a939897137596bb73ad7a028d0beaaa10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af910c7cf2b85bdc2c399cfe8dbfb8b9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#af910c7cf2b85bdc2c399cfe8dbfb8b9c">densmatr_calcPurityLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:af910c7cf2b85bdc2c399cfe8dbfb8b9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a891358c784d97101f9fcdffbb5ebe00e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a891358c784d97101f9fcdffbb5ebe00e">densmatr_collapseToKnownProbOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, int outcome, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> totalStateProb)</td></tr>
<tr class="memdesc:a891358c784d97101f9fcdffbb5ebe00e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero.  <a href="#a891358c784d97101f9fcdffbb5ebe00e">More...</a><br /></td></tr>
<tr class="separator:a891358c784d97101f9fcdffbb5ebe00e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a101e7ef38c5d654a697dafe14562dcee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a101e7ef38c5d654a697dafe14562dcee">densmatr_findProbabilityOfZeroLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit)</td></tr>
<tr class="separator:a101e7ef38c5d654a697dafe14562dcee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a155f53efc45c16803d7539c2c199d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a20a155f53efc45c16803d7539c2c199d">densmatr_initClassicalState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int stateInd)</td></tr>
<tr class="separator:a20a155f53efc45c16803d7539c2c199d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b2ac0b00afa495f385520b2c5fa839"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ad5b2ac0b00afa495f385520b2c5fa839">densmatr_initPlusState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:ad5b2ac0b00afa495f385520b2c5fa839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b36518c8fbbc3a5084bb4ad1fb05ea5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a1b36518c8fbbc3a5084bb4ad1fb05ea5">densmatr_initPureStateLocal</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg, <a class="el" href="structQureg.html">Qureg</a> copyQureg)</td></tr>
<tr class="separator:a1b36518c8fbbc3a5084bb4ad1fb05ea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5531686f00049314901f17a0e03f5979"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a5531686f00049314901f17a0e03f5979">densmatr_mixDampingDephase</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase)</td></tr>
<tr class="separator:a5531686f00049314901f17a0e03f5979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28d2a35fde2952211f5898a76275d93d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a28d2a35fde2952211f5898a76275d93d">densmatr_mixDampingDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> damping)</td></tr>
<tr class="separator:a28d2a35fde2952211f5898a76275d93d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cc805451304b8ad4429c7107f90ab3b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7cc805451304b8ad4429c7107f90ab3b">densmatr_mixDampingLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> damping)</td></tr>
<tr class="separator:a7cc805451304b8ad4429c7107f90ab3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8adaba9dbdad6f7ab41ae4b8db0abefe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8adaba9dbdad6f7ab41ae4b8db0abefe">densmatr_mixDensityMatrix</a> (<a class="el" href="structQureg.html">Qureg</a> combineQureg, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> otherProb, <a class="el" href="structQureg.html">Qureg</a> otherQureg)</td></tr>
<tr class="separator:a8adaba9dbdad6f7ab41ae4b8db0abefe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a515b6a920b1715d4eae25dcf29f39b95"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a515b6a920b1715d4eae25dcf29f39b95">densmatr_mixDephasing</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase)</td></tr>
<tr class="separator:a515b6a920b1715d4eae25dcf29f39b95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc485aea8dccf1678f80fa9c5df6724a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#acc485aea8dccf1678f80fa9c5df6724a">densmatr_mixDepolarisingDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> depolLevel)</td></tr>
<tr class="separator:acc485aea8dccf1678f80fa9c5df6724a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1807899a1c39506427433739562670ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a1807899a1c39506427433739562670ec">densmatr_mixDepolarisingLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> depolLevel)</td></tr>
<tr class="separator:a1807899a1c39506427433739562670ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5090b080392ab9be8fcf538161d4e5c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a5090b080392ab9be8fcf538161d4e5c1">densmatr_mixTwoQubitDephasing</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int qubit1, const int qubit2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase)</td></tr>
<tr class="separator:a5090b080392ab9be8fcf538161d4e5c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac497197e66d7024fc6bf7ace120b3de5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac497197e66d7024fc6bf7ace120b3de5">densmatr_mixTwoQubitDepolarisingDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, const int qubit2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> delta, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> gamma)</td></tr>
<tr class="separator:ac497197e66d7024fc6bf7ace120b3de5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3510f01d4d15dcc545564eb84c668cad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a3510f01d4d15dcc545564eb84c668cad">densmatr_mixTwoQubitDepolarisingLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qubit1, int qubit2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> delta, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> gamma)</td></tr>
<tr class="separator:a3510f01d4d15dcc545564eb84c668cad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae90f82418e0aa67218d733dbbc681998"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ae90f82418e0aa67218d733dbbc681998">densmatr_mixTwoQubitDepolarisingLocalPart1</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qubit1, int qubit2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> delta)</td></tr>
<tr class="separator:ae90f82418e0aa67218d733dbbc681998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af82f6c9317f51a2048ddd3eb24c2959c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#af82f6c9317f51a2048ddd3eb24c2959c">densmatr_mixTwoQubitDepolarisingQ1LocalQ2DistributedPart3</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, const int qubit2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> delta, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> gamma)</td></tr>
<tr class="separator:af82f6c9317f51a2048ddd3eb24c2959c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b578690aa76d1e9cac9dc964d713f38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a4b578690aa76d1e9cac9dc964d713f38">densmatr_oneQubitDegradeOffDiagonal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain)</td></tr>
<tr class="separator:a4b578690aa76d1e9cac9dc964d713f38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a3d13a0da8e43b83660b1f972a3116"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a59a3d13a0da8e43b83660b1f972a3116">destroyDiagonalOperator</a> (<a class="el" href="structDiagonalOperator.html">DiagonalOperator</a> op)</td></tr>
<tr class="memdesc:a59a3d13a0da8e43b83660b1f972a3116"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys a <a class="el" href="structDiagonalOperator.html" title="Represents a diagonal compelx operator on the full Hilbert state of a Qureg. ">DiagonalOperator</a>, freeing CPU and (if allocated) GPU memory.  <a href="#a59a3d13a0da8e43b83660b1f972a3116">More...</a><br /></td></tr>
<tr class="separator:a59a3d13a0da8e43b83660b1f972a3116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37e522505286f17fe6ef74b9f607a5c6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a37e522505286f17fe6ef74b9f607a5c6">getBitMaskParity</a> (long long int mask)</td></tr>
<tr class="separator:a37e522505286f17fe6ef74b9f607a5c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a031a99b7e97779f3dc782feffe86e779"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> norm, long long int startInd, long long int numAmps)</td></tr>
<tr class="separator:a031a99b7e97779f3dc782feffe86e779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4231f79fe9498e4fd87cc70cde5a9d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#afa4231f79fe9498e4fd87cc70cde5a9d">qsortComp</a> (const void *a, const void *b)</td></tr>
<tr class="separator:afa4231f79fe9498e4fd87cc70cde5a9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4103b0bd0dc7eaf078aa2a4e6446c89d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a4103b0bd0dc7eaf078aa2a4e6446c89d">statevec_applyDiagonalOperator</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structDiagonalOperator.html">DiagonalOperator</a> op)</td></tr>
<tr class="separator:a4103b0bd0dc7eaf078aa2a4e6446c89d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fbb3b693f25dde1e9e3dc87dc1984f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplex.html">Complex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a6fbb3b693f25dde1e9e3dc87dc1984f7">statevec_calcInnerProductLocal</a> (<a class="el" href="structQureg.html">Qureg</a> bra, <a class="el" href="structQureg.html">Qureg</a> ket)</td></tr>
<tr class="separator:a6fbb3b693f25dde1e9e3dc87dc1984f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b77089145184d990848cd66993aa8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa4b77089145184d990848cd66993aa8b">statevec_cloneQureg</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg, <a class="el" href="structQureg.html">Qureg</a> copyQureg)</td></tr>
<tr class="separator:aa4b77089145184d990848cd66993aa8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd82c94cfac89eacb901348ff0d06af8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#acd82c94cfac89eacb901348ff0d06af8">statevec_collapseToKnownProbOutcomeDistributedRenorm</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, const <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> totalProbability)</td></tr>
<tr class="memdesc:acd82c94cfac89eacb901348ff0d06af8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1.  <a href="#acd82c94cfac89eacb901348ff0d06af8">More...</a><br /></td></tr>
<tr class="separator:acd82c94cfac89eacb901348ff0d06af8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab02bce0ebbb8f624e8ced8b09b99cdef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab02bce0ebbb8f624e8ced8b09b99cdef">statevec_collapseToKnownProbOutcomeLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit, int outcome, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> totalProbability)</td></tr>
<tr class="memdesc:ab02bce0ebbb8f624e8ced8b09b99cdef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1.  <a href="#ab02bce0ebbb8f624e8ced8b09b99cdef">More...</a><br /></td></tr>
<tr class="separator:ab02bce0ebbb8f624e8ced8b09b99cdef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ea68e9132ed9db9c242353a33dba2f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7ea68e9132ed9db9c242353a33dba2f0">statevec_collapseToOutcomeDistributedSetZero</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="memdesc:a7ea68e9132ed9db9c242353a33dba2f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all amplitudes in one chunk to 0.  <a href="#a7ea68e9132ed9db9c242353a33dba2f0">More...</a><br /></td></tr>
<tr class="separator:a7ea68e9132ed9db9c242353a33dba2f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a7a35628b1c1eb47336deb9afda5b68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0a7a35628b1c1eb47336deb9afda5b68">statevec_compactUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a0a7a35628b1c1eb47336deb9afda5b68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a0a7a35628b1c1eb47336deb9afda5b68">More...</a><br /></td></tr>
<tr class="separator:a0a7a35628b1c1eb47336deb9afda5b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5865e66a6e0993ae17d400c9ee0eb43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa5865e66a6e0993ae17d400c9ee0eb43">statevec_compactUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="separator:aa5865e66a6e0993ae17d400c9ee0eb43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6cecbad32a03416138b321cdc1a2c33"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ae6cecbad32a03416138b321cdc1a2c33">statevec_compareStates</a> (<a class="el" href="structQureg.html">Qureg</a> mq1, <a class="el" href="structQureg.html">Qureg</a> mq2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> precision)</td></tr>
<tr class="separator:ae6cecbad32a03416138b321cdc1a2c33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230eea38971f36de8f5437b1f47aaf3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a230eea38971f36de8f5437b1f47aaf3e">statevec_controlledCompactUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a230eea38971f36de8f5437b1f47aaf3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a230eea38971f36de8f5437b1f47aaf3e">More...</a><br /></td></tr>
<tr class="separator:a230eea38971f36de8f5437b1f47aaf3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e5527c6e144fab8062ea5296e8bdf2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0e5527c6e144fab8062ea5296e8bdf2a">statevec_controlledCompactUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="separator:a0e5527c6e144fab8062ea5296e8bdf2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f17a0969e16f9ce9b55abd46bd732a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a97f17a0969e16f9ce9b55abd46bd732a">statevec_controlledNotDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a97f17a0969e16f9ce9b55abd46bd732a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a97f17a0969e16f9ce9b55abd46bd732a">More...</a><br /></td></tr>
<tr class="separator:a97f17a0969e16f9ce9b55abd46bd732a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c9685e4ad1f44cfd6243e0c4435893"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a11c9685e4ad1f44cfd6243e0c4435893">statevec_controlledNotLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit)</td></tr>
<tr class="separator:a11c9685e4ad1f44cfd6243e0c4435893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad35691d74b79e759c0fc53862c68b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a3ad35691d74b79e759c0fc53862c68b5">statevec_controlledPauliYDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, const int conjFac)</td></tr>
<tr class="separator:a3ad35691d74b79e759c0fc53862c68b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9028deac63419d71d523f73229a7bd84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a9028deac63419d71d523f73229a7bd84">statevec_controlledPauliYLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, const int conjFac)</td></tr>
<tr class="separator:a9028deac63419d71d523f73229a7bd84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c0067cb9f243ead20de7392aea328bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7c0067cb9f243ead20de7392aea328bc">statevec_controlledPhaseFlip</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int idQubit1, const int idQubit2)</td></tr>
<tr class="separator:a7c0067cb9f243ead20de7392aea328bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeb715f3f2c167f9bfbe92b75f5988ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#adeb715f3f2c167f9bfbe92b75f5988ce">statevec_controlledPhaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int idQubit1, const int idQubit2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:adeb715f3f2c167f9bfbe92b75f5988ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14681cbcc8f530333a9570328886b32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab14681cbcc8f530333a9570328886b32">statevec_controlledUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:ab14681cbcc8f530333a9570328886b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#ab14681cbcc8f530333a9570328886b32">More...</a><br /></td></tr>
<tr class="separator:ab14681cbcc8f530333a9570328886b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0c120ac374b402c576c4b38bcda9992"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac0c120ac374b402c576c4b38bcda9992">statevec_controlledUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:ac0c120ac374b402c576c4b38bcda9992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a365bbb1b80cb00405c8bf1a4fa1ea8e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a365bbb1b80cb00405c8bf1a4fa1ea8e5">statevec_createQureg</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="separator:a365bbb1b80cb00405c8bf1a4fa1ea8e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a52ad9f9ad9b2fd6a76f6d433b3b217"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a2a52ad9f9ad9b2fd6a76f6d433b3b217">statevec_destroyQureg</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="separator:a2a52ad9f9ad9b2fd6a76f6d433b3b217"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a430d98e35f1eae7f0815ac539057cf67"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a430d98e35f1eae7f0815ac539057cf67">statevec_findProbabilityOfZeroDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="memdesc:a430d98e35f1eae7f0815ac539057cf67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk.  <a href="#a430d98e35f1eae7f0815ac539057cf67">More...</a><br /></td></tr>
<tr class="separator:a430d98e35f1eae7f0815ac539057cf67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa06d0143cea46f1e425c61ac6f6f9a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#afa06d0143cea46f1e425c61ac6f6f9a2">statevec_findProbabilityOfZeroLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit)</td></tr>
<tr class="memdesc:afa06d0143cea46f1e425c61ac6f6f9a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk.  <a href="#afa06d0143cea46f1e425c61ac6f6f9a2">More...</a><br /></td></tr>
<tr class="separator:afa06d0143cea46f1e425c61ac6f6f9a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6870e335f2a78b724f603cd9f820b9ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a6870e335f2a78b724f603cd9f820b9ab">statevec_getEnvironmentString</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> env, <a class="el" href="structQureg.html">Qureg</a> qureg, char str[200])</td></tr>
<tr class="separator:a6870e335f2a78b724f603cd9f820b9ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea6570b95fdfa102511ccd1fcb30685"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#abea6570b95fdfa102511ccd1fcb30685">statevec_hadamardDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut, int updateUpper)</td></tr>
<tr class="memdesc:abea6570b95fdfa102511ccd1fcb30685"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="#abea6570b95fdfa102511ccd1fcb30685">More...</a><br /></td></tr>
<tr class="separator:abea6570b95fdfa102511ccd1fcb30685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f9ade18290c82bbb2c4a706b3d5999"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a24f9ade18290c82bbb2c4a706b3d5999">statevec_hadamardLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:a24f9ade18290c82bbb2c4a706b3d5999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a758bad4237ff0bf3b4ff5be626a982ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a758bad4237ff0bf3b4ff5be626a982ae">statevec_initBlankState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:a758bad4237ff0bf3b4ff5be626a982ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a288dc4b46bdacd69cbf4a6fd070d26a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a288dc4b46bdacd69cbf4a6fd070d26a7">statevec_initClassicalState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int stateInd)</td></tr>
<tr class="separator:a288dc4b46bdacd69cbf4a6fd070d26a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a482fc361fd5f08075404c72e536316a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a482fc361fd5f08075404c72e536316a0">statevec_initPlusState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:a482fc361fd5f08075404c72e536316a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38445cdb2a18671a7c73112ce3337acb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a38445cdb2a18671a7c73112ce3337acb">statevec_initStateDebug</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="memdesc:a38445cdb2a18671a7c73112ce3337acb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value.  <a href="#a38445cdb2a18671a7c73112ce3337acb">More...</a><br /></td></tr>
<tr class="separator:a38445cdb2a18671a7c73112ce3337acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05756b45f10135bb2eeb07380f806c20"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a05756b45f10135bb2eeb07380f806c20">statevec_initStateFromSingleFile</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, char filename[200], <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="separator:a05756b45f10135bb2eeb07380f806c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923906770cac0da9e3459bae58de9e64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a923906770cac0da9e3459bae58de9e64">statevec_initStateOfSingleQubit</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, int qubitId, int outcome)</td></tr>
<tr class="memdesc:a923906770cac0da9e3459bae58de9e64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one.  <a href="#a923906770cac0da9e3459bae58de9e64">More...</a><br /></td></tr>
<tr class="separator:a923906770cac0da9e3459bae58de9e64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ca0c6ba07ab2b4b437321bf17efc966"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a2ca0c6ba07ab2b4b437321bf17efc966">statevec_initZeroState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:a2ca0c6ba07ab2b4b437321bf17efc966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc5726bc7f899d5fd85454ffcc64f60c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#acc5726bc7f899d5fd85454ffcc64f60c">statevec_multiControlledMultiQubitUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int ctrlMask, int *targs, const int numTargs, <a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a> u)</td></tr>
<tr class="separator:acc5726bc7f899d5fd85454ffcc64f60c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4ee5979d475e8c729294b8ef7e0270d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac4ee5979d475e8c729294b8ef7e0270d">statevec_multiControlledPhaseFlip</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, int numControlQubits)</td></tr>
<tr class="separator:ac4ee5979d475e8c729294b8ef7e0270d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa662796ea6e0f471143c53becae8c12c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa662796ea6e0f471143c53becae8c12c">statevec_multiControlledPhaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, int numControlQubits, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:aa662796ea6e0f471143c53becae8c12c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7f5f0bf7fa945d46eb51e79e00a8dfd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa7f5f0bf7fa945d46eb51e79e00a8dfd">statevec_multiControlledTwoQubitUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int ctrlMask, const int q1, const int q2, <a class="el" href="structComplexMatrix4.html">ComplexMatrix4</a> u)</td></tr>
<tr class="separator:aa7f5f0bf7fa945d46eb51e79e00a8dfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a623e5479f5dd45e87fe2acef55620771"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a623e5479f5dd45e87fe2acef55620771">statevec_multiControlledUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, long long int ctrlQubitsMask, long long int ctrlFlipMask, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a623e5479f5dd45e87fe2acef55620771"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a623e5479f5dd45e87fe2acef55620771">More...</a><br /></td></tr>
<tr class="separator:a623e5479f5dd45e87fe2acef55620771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae757d3b816aa7ba7bea13334a9b77441"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ae757d3b816aa7ba7bea13334a9b77441">statevec_multiControlledUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, long long int ctrlQubitsMask, long long int ctrlFlipMask, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:ae757d3b816aa7ba7bea13334a9b77441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d88b4ed94ab024e5e7b2f1f4f505b44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8d88b4ed94ab024e5e7b2f1f4f505b44">statevec_multiRotateZ</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int mask, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:a8d88b4ed94ab024e5e7b2f1f4f505b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a464efbd1d7ca5a7b25c83ada001955c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a464efbd1d7ca5a7b25c83ada001955c2">statevec_pauliXDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, ComplexArray stateVecIn, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a464efbd1d7ca5a7b25c83ada001955c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a464efbd1d7ca5a7b25c83ada001955c2">More...</a><br /></td></tr>
<tr class="separator:a464efbd1d7ca5a7b25c83ada001955c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a842aaecd6d6cdc194c0b7c84623d2111"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a842aaecd6d6cdc194c0b7c84623d2111">statevec_pauliXLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:a842aaecd6d6cdc194c0b7c84623d2111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3528cf8d741807987d8150d59ccb1ba3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a3528cf8d741807987d8150d59ccb1ba3">statevec_pauliYDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper, const int conjFac)</td></tr>
<tr class="memdesc:a3528cf8d741807987d8150d59ccb1ba3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by +-{{0,-i},{i,0}.  <a href="#a3528cf8d741807987d8150d59ccb1ba3">More...</a><br /></td></tr>
<tr class="separator:a3528cf8d741807987d8150d59ccb1ba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8edf5f2066b05fb343931f45e2bec8f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8edf5f2066b05fb343931f45e2bec8f8">statevec_pauliYLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, const int conjFac)</td></tr>
<tr class="separator:a8edf5f2066b05fb343931f45e2bec8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8972669148af60d7e1c09687f69673d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> term)</td></tr>
<tr class="separator:a8972669148af60d7e1c09687f69673d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e57230c7995447039e62a84c0a36524"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a1e57230c7995447039e62a84c0a36524">statevec_reportStateToScreen</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env, int reportRank)</td></tr>
<tr class="separator:a1e57230c7995447039e62a84c0a36524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa121d55f2ca09c06a96ddcd433c60b0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa121d55f2ca09c06a96ddcd433c60b0f">statevec_setAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int startInd, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reals, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imags, long long int numAmps)</td></tr>
<tr class="separator:aa121d55f2ca09c06a96ddcd433c60b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad64a23933361fafc1b6b1787759c2663"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ad64a23933361fafc1b6b1787759c2663">statevec_setWeightedQureg</a> (<a class="el" href="structComplex.html">Complex</a> fac1, <a class="el" href="structQureg.html">Qureg</a> qureg1, <a class="el" href="structComplex.html">Complex</a> fac2, <a class="el" href="structQureg.html">Qureg</a> qureg2, <a class="el" href="structComplex.html">Complex</a> facOut, <a class="el" href="structQureg.html">Qureg</a> out)</td></tr>
<tr class="separator:ad64a23933361fafc1b6b1787759c2663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe74a5a9db8340e37b80fbc77338894d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#abe74a5a9db8340e37b80fbc77338894d">statevec_swapQubitAmpsDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int pairRank, int qb1, int qb2)</td></tr>
<tr class="memdesc:abe74a5a9db8340e37b80fbc77338894d"><td class="mdescLeft">&#160;</td><td class="mdescRight">qureg.pairStateVec contains the entire set of amplitudes of the paired node which includes the set of all amplitudes which need to be swapped between |..0..1..&gt; and |..1..0..&gt;  <a href="#abe74a5a9db8340e37b80fbc77338894d">More...</a><br /></td></tr>
<tr class="separator:abe74a5a9db8340e37b80fbc77338894d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b51a28caa8792a3f0c637409a694b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab5b51a28caa8792a3f0c637409a694b0">statevec_swapQubitAmpsLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qb1, int qb2)</td></tr>
<tr class="memdesc:ab5b51a28caa8792a3f0c637409a694b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">It is ensured that all amplitudes needing to be swapped are on this node.  <a href="#ab5b51a28caa8792a3f0c637409a694b0">More...</a><br /></td></tr>
<tr class="separator:ab5b51a28caa8792a3f0c637409a694b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce2c2fd54df25495e99dc5b95bed4b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0ce2c2fd54df25495e99dc5b95bed4b2">statevec_unitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a0ce2c2fd54df25495e99dc5b95bed4b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a0ce2c2fd54df25495e99dc5b95bed4b2">More...</a><br /></td></tr>
<tr class="separator:a0ce2c2fd54df25495e99dc5b95bed4b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f62ff38deae8ef012024d416d749c00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a9f62ff38deae8ef012024d416d749c00">statevec_unitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:a9f62ff38deae8ef012024d416d749c00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6d360ce0606d16e3757ab38715c6614"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa6d360ce0606d16e3757ab38715c6614">syncDiagonalOperator</a> (<a class="el" href="structDiagonalOperator.html">DiagonalOperator</a> op)</td></tr>
<tr class="memdesc:aa6d360ce0606d16e3757ab38715c6614"><td class="mdescLeft">&#160;</td><td class="mdescRight">Syncs the .real and .imag components of <code>op</code> to GPU memory, where it persists until being sync'd again, or destroyed.  <a href="#aa6d360ce0606d16e3757ab38715c6614">More...</a><br /></td></tr>
<tr class="separator:aa6d360ce0606d16e3757ab38715c6614"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5168399122f7f53977dcc9ceda4f458"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int startInd, long long int numAmps)</td></tr>
<tr class="separator:ac5168399122f7f53977dcc9ceda4f458"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The core of the CPU backend functionality. </p>
<p>The CPU/MPI implementations of the pure state functions in ../QuEST_ops_pure.h are in <a class="el" href="QuEST__cpu__local_8c.html" title="An implementation of the pure backend in ../QuEST_ops_pure.h for a local (non-MPI, non-GPU) environment. ">QuEST_cpu_local.c</a> and <a class="el" href="QuEST__cpu__distributed_8c.html" title="An implementation of the backend in ../QuEST_ops.h for an MPI environment. ">QuEST_cpu_distributed.c</a> which mostly wrap the core functions defined here. Some additional hardware-agnostic functions are defined here </p>

<p class="definition">Definition in file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0abdff5f6065f9d57065345e6d90fc94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0abdff5f6065f9d57065345e6d90fc94">&#9670;&nbsp;</a></span>alternateNormZeroingSomeAmpBlocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void alternateNormZeroingSomeAmpBlocks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>norm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>normFirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startAmpInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>blockSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00818">818</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l00808">normaliseSomeAmps()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00798">zeroSomeAmps()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00849">densmatr_collapseToKnownProbOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  {     </div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numDubBlocks = numAmps / (2*blockSize);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> blockStartInd;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    </div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">if</span> (normFirst) {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dubBlockInd;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="preprocessor"># pragma omp parallel for schedule (static) private (blockStartInd)</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">for</span> (dubBlockInd=0; dubBlockInd &lt; numDubBlocks; dubBlockInd++) {</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            blockStartInd = startAmpInd + dubBlockInd*2*blockSize;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, norm, blockStartInd,             blockSize); <span class="comment">// |0&gt;&lt;0|</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(     qureg,       blockStartInd + blockSize, blockSize);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        }</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dubBlockInd;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="preprocessor"># pragma omp parallel for schedule (static) private (blockStartInd)</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">for</span> (dubBlockInd=0; dubBlockInd &lt; numDubBlocks; dubBlockInd++) {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            blockStartInd = startAmpInd + dubBlockInd*2*blockSize;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(     qureg,       blockStartInd,             blockSize);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, norm, blockStartInd + blockSize, blockSize); <span class="comment">// |1&gt;&lt;1|</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        }</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    }</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;}</div><div class="ttc" id="QuEST__cpu_8c_html_a031a99b7e97779f3dc782feffe86e779"><div class="ttname"><a href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a></div><div class="ttdeci">void normaliseSomeAmps(Qureg qureg, qreal norm, long long int startInd, long long int numAmps)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00808">QuEST_cpu.c:808</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_ac5168399122f7f53977dcc9ceda4f458"><div class="ttname"><a href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a></div><div class="ttdeci">void zeroSomeAmps(Qureg qureg, long long int startInd, long long int numAmps)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00798">QuEST_cpu.c:798</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab81b8b4e355597b50d7bbe264acf2efc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab81b8b4e355597b50d7bbe264acf2efc">&#9670;&nbsp;</a></span>createDiagonalOperator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDiagonalOperator.html">DiagonalOperator</a> createDiagonalOperator </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a <a class="el" href="structDiagonalOperator.html" title="Represents a diagonal compelx operator on the full Hilbert state of a Qureg. ">DiagonalOperator</a> representing a diagonal operator on the full Hilbert space of a <a class="el" href="structQureg.html" title="Represents a system of qubits. ">Qureg</a>. </p>
<p>This can only be applied to pure states of an equal number of qubits, using applyDiagonalOperator. Note that there is no requirement that the operator is Hermitian - any complex operator is allowed.</p>
<p>Allocates space for 2^n complex amplitudes, which are initially zero. This memory must later be freed with destroyDiagonalOperator.</p>
<p>In GPU mode, this also creates persistent memory on the GPU. After modifying operator.real and .imag, the user must call <a class="el" href="QuEST_8h.html#aa6d360ce0606d16e3757ab38715c6614" title="Syncs the .real and .imag components of op to GPU memory, where it persists until being sync&#39;d again...">syncDiagonalOperator()</a> to modify the operator stored in the GPU.</p>
<p>In distributed mode, the memory for the diagonal operator is spread evenly between the available nodes, such that each node contains only operator.numValsPerChunk complex values. Users must therefore exercise care in modifying .real and .imag. E.g. the following is valid code when when distributed between TWO nodes: </p><pre class="fragment">// create {1,2,3,4,5,6,7,8, 9,10,11,12,13,14,15,16}
DiagonalOperator op = createDiagonalOperator(4, env); // 16 amplitudes total
for (int i=0; i&lt;8; i++) {
    if (env.rank == 0)
        op.real[i] = (i+1);
    if (env.rank == 1)
        op.real[i] = (i+1+8);
}
</pre><dl class="section return"><dt>Returns</dt><dd>a <a class="el" href="structDiagonalOperator.html" title="Represents a diagonal compelx operator on the full Hilbert state of a Qureg. ">DiagonalOperator</a> instance, with 2^n-length .real and .imag arrays </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numQubits</td><td>number of qubits in the operator. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>numQubits</code> &lt;= 0 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00032">32</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                                                     {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    </div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">if</span> (numQubits &lt;= 0) {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        printf(<span class="stringliteral">&quot;Cannot allocate 0-qubit operator!\n&quot;</span>);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        exit(EXIT_FAILURE);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    </div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// the 2^numQubits values will be evenly split between the env.numRanks nodes</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="structDiagonalOperator.html">DiagonalOperator</a> op;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    op.<a class="code" href="structDiagonalOperator.html#a3ab20b69a28a433dcd4d2283fcbd8838">numQubits</a> = numQubits;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    op.<a class="code" href="structDiagonalOperator.html#aa21cc3127dca0816ac6e4fd28b43576c">numValsPerChunk</a> = (1LL &lt;&lt; numQubits) / env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// allocate CPU memory (initialised to zero)</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    op.<a class="code" href="structDiagonalOperator.html#a1e3d52728cd3f9fafff974ce4c6ea7e0">real</a> = (<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>*) calloc(op.<a class="code" href="structDiagonalOperator.html#aa21cc3127dca0816ac6e4fd28b43576c">numValsPerChunk</a>, <span class="keyword">sizeof</span>(<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>));</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    op.<a class="code" href="structDiagonalOperator.html#ac4f9117b53a278326df27dea6a90f335">imag</a> = (<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>*) calloc(op.<a class="code" href="structDiagonalOperator.html#aa21cc3127dca0816ac6e4fd28b43576c">numValsPerChunk</a>, <span class="keyword">sizeof</span>(<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>));</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// check cpu memory allocation was successful</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> ( !op.<a class="code" href="structDiagonalOperator.html#a1e3d52728cd3f9fafff974ce4c6ea7e0">real</a> || !op.<a class="code" href="structDiagonalOperator.html#ac4f9117b53a278326df27dea6a90f335">imag</a> ) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        printf(<span class="stringliteral">&quot;Could not allocate memory!\n&quot;</span>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        exit(EXIT_FAILURE);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">return</span> op;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div><div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00141">QuEST.h:141</a></div></div>
<div class="ttc" id="structDiagonalOperator_html_aa21cc3127dca0816ac6e4fd28b43576c"><div class="ttname"><a href="structDiagonalOperator.html#aa21cc3127dca0816ac6e4fd28b43576c">DiagonalOperator::numValsPerChunk</a></div><div class="ttdeci">long long int numValsPerChunk</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00154">QuEST.h:154</a></div></div>
<div class="ttc" id="structDiagonalOperator_html_a1e3d52728cd3f9fafff974ce4c6ea7e0"><div class="ttname"><a href="structDiagonalOperator.html#a1e3d52728cd3f9fafff974ce4c6ea7e0">DiagonalOperator::real</a></div><div class="ttdeci">qreal * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00155">QuEST.h:155</a></div></div>
<div class="ttc" id="structDiagonalOperator_html_ac4f9117b53a278326df27dea6a90f335"><div class="ttname"><a href="structDiagonalOperator.html#ac4f9117b53a278326df27dea6a90f335">DiagonalOperator::imag</a></div><div class="ttdeci">qreal * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00156">QuEST.h:156</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structDiagonalOperator_html"><div class="ttname"><a href="structDiagonalOperator.html">DiagonalOperator</a></div><div class="ttdoc">Represents a diagonal compelx operator on the full Hilbert state of a Qureg. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00151">QuEST.h:151</a></div></div>
<div class="ttc" id="structDiagonalOperator_html_a3ab20b69a28a433dcd4d2283fcbd8838"><div class="ttname"><a href="structDiagonalOperator.html#a3ab20b69a28a433dcd4d2283fcbd8838">DiagonalOperator::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00153">QuEST.h:153</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7772f97cb4d92a9825bf3b7c82c3230c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7772f97cb4d92a9825bf3b7c82c3230c">&#9670;&nbsp;</a></span>densmatr_calcFidelityLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcFidelityLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>pureState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes a few dens-columns-worth of (vec^*T) dens * vec </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01022">1022</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00114">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00123">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00408">densmatr_calcFidelity()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                                               {</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        </div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">/* Here, elements of pureState are not accessed (instead grabbed from qureg.pair).</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">     * We only consult the attributes.</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">     * qureg is a density matrix, and pureState is a statevector.</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">     * Every node contains as many columns of qureg as amps by pureState.</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">     * (each node contains an integer, exponent-of-2 number of whole columns of qureg)</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">     * Ergo, this node contains columns:</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">     * qureg.chunkID * pureState.numAmpsPerChunk  to</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">     * (qureg.chunkID + 1) * pureState.numAmpsPerChunk</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">     * The first pureState.numAmpsTotal elements of qureg.pairStateVec are the</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">     * entire pureState state-vector</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    </div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">// unpack everything for OPENMP</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecRe  = qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecIm  = qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* densRe = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* densIm = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    </div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordtype">int</span> row, col;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordtype">int</span> dim = (int) pureState.<a class="code" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a>; </div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordtype">int</span> colsPerNode = (<span class="keywordtype">int</span>) pureState.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">// using only int, because density matrix has squared as many amps so its </span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">// iteration would be impossible if the pureStates numAmpsTotal didn&#39;t fit into int</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    </div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="comment">// starting GLOBAL column index of the qureg columns on this node</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordtype">int</span> startCol = (int) (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * pureState.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    </div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> densElemRe, densElemIm;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> prefacRe, prefacIm;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rowSumRe, rowSumIm;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> vecElemRe, vecElemIm;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    </div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="comment">// quantity computed by this node</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> globalSumRe = 0;   <span class="comment">// imag-component is assumed zero</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    </div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="preprocessor">    shared    (vecRe,vecIm,densRe,densIm, dim,colsPerNode,startCol) \</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="preprocessor">    private   (row,col, prefacRe,prefacIm, rowSumRe,rowSumIm, densElemRe,densElemIm, vecElemRe,vecElemIm) \</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="preprocessor">    reduction ( +:globalSumRe )</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="comment">// indices of my GLOBAL row</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">for</span> (row=0; row &lt; dim; row++) {</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            </div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            <span class="comment">// single element of conj(pureState)</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            prefacRe =   vecRe[row];</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            prefacIm = - vecIm[row];</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                    </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            rowSumRe = 0;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            rowSumIm = 0;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            </div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <span class="comment">// indices of my LOCAL column</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="keywordflow">for</span> (col=0; col &lt; colsPerNode; col++) {</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            </div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                <span class="comment">// my local density element</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                densElemRe = densRe[row + dim*col];</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                densElemIm = densIm[row + dim*col];</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            </div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                <span class="comment">// state-vector element</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                vecElemRe = vecRe[startCol + col];</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                vecElemIm = vecIm[startCol + col];</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            </div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                rowSumRe += densElemRe*vecElemRe - densElemIm*vecElemIm;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                rowSumIm += densElemRe*vecElemIm + densElemIm*vecElemRe;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        </div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            globalSumRe += rowSumRe*prefacRe - rowSumIm*prefacIm;   </div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        }</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    }</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    </div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">return</span> globalSumRe;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_adef4935cac95763c29164cf99b144ed4"><div class="ttname"><a href="structQureg.html#adef4935cac95763c29164cf99b144ed4">Qureg::numAmpsTotal</a></div><div class="ttdeci">long long int numAmpsTotal</div><div class="ttdoc">Total number of amplitudes, which are possibly distributed among machines. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00114">QuEST.h:114</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00123">QuEST.h:123</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a939897137596bb73ad7a028d0beaaa10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939897137596bb73ad7a028d0beaaa10">&#9670;&nbsp;</a></span>densmatr_calcHilbertSchmidtDistanceSquaredLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcHilbertSchmidtDistanceSquaredLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes Tr((a-b) conjTrans(a-b)) = sum of abs values of (a-b) </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00987">987</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00423">densmatr_calcHilbertSchmidtDistance()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                                                                        {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    </div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = a.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        </div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *aRe = a.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *aIm = b.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *bRe = a.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *bIm = b.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    </div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> trace = 0;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> difRe, difIm;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    </div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="preprocessor">    shared    (aRe,aIm, bRe,bIm, numAmps) \</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="preprocessor">    private   (index,difRe,difIm) \</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="preprocessor">    reduction ( +:trace )</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                        </div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            difRe = aRe[index] - bRe[index];</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            difIm = aIm[index] - bIm[index];</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            trace += difRe*difRe + difIm*difIm;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        }</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    </div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">return</span> trace;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af910c7cf2b85bdc2c399cfe8dbfb8b9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af910c7cf2b85bdc2c399cfe8dbfb8b9c">&#9670;&nbsp;</a></span>densmatr_calcPurityLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcPurityLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00925">925</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01273">densmatr_calcPurity()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                            {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    </div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">/* sum of qureg^2, which is sum_i |qureg[i]|^2 */</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        </div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> trace = 0;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecRe = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecIm = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    </div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="preprocessor">    shared    (vecRe, vecIm, numAmps) \</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="preprocessor">    private   (index) \</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="preprocessor">    reduction ( +:trace )</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    {</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                        </div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            trace += vecRe[index]*vecRe[index] + vecIm[index]*vecIm[index];</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    </div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">return</span> trace;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a891358c784d97101f9fcdffbb5ebe00e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a891358c784d97101f9fcdffbb5ebe00e">&#9670;&nbsp;</a></span>densmatr_collapseToKnownProbOutcome()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_collapseToKnownProbOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>totalStateProb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero. </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00849">849</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l00818">alternateNormZeroingSomeAmpBlocks()</a>, <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00808">normaliseSomeAmps()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00798">zeroSomeAmps()</a>.</p>
<div class="fragment"><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                                                                                                                 {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="comment">// only (global) indices (as bit sequence): &#39;* outcome *(n+q) outcome *q are spared</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="comment">// where n = measureQubit, q = qureg.numQubitsRepresented.</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">// We can thus step in blocks of 2^q+n, killing every second, and inside the others,</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="comment">//  stepping in sub-blocks of 2^q, killing every second.</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">// When outcome=1, we offset the start of these blocks by their size.</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerBlockSize = (1LL &lt;&lt; measureQubit);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerBlockSize = (1LL &lt;&lt; (measureQubit + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    </div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="comment">// Because there are 2^a number of nodes(/chunks), each node will contain 2^b number of blocks,</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">// or each block will span 2^c number of nodes. Similarly for the innerblocks.</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> locNumAmps = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalStartInd = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * locNumAmps;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordtype">int</span> innerBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(measureQubit, globalStartInd);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordtype">int</span> outerBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(measureQubit + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>, globalStartInd);</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    </div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">// If this chunk&#39;s amps are entirely inside an outer block</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">if</span> (locNumAmps &lt;= outerBlockSize) {</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        </div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="comment">// if this is an undesired outer block, kill all elems</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordflow">if</span> (outerBit != outcome)</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        </div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="comment">// othwerwise, if this is a desired outer block, and also entirely an inner block</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">if</span> (locNumAmps &lt;= innerBlockSize) {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            </div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            <span class="comment">// and that inner block is undesired, kill all elems</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <span class="keywordflow">if</span> (innerBit != outcome)</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="comment">// otherwise normalise all elems</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, totalStateProb, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                </div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="comment">// otherwise this is a desired outer block which contains 2^a inner blocks; kill/renorm every second inner block</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            qureg, totalStateProb, innerBit==outcome, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, innerBlockSize);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    </div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">// Otherwise, this chunk&#39;s amps contain multiple outer blocks (and hence multiple inner blocks)</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numOuterDoubleBlocks = locNumAmps / (2*outerBlockSize);</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> firstBlockInd;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    </div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// alternate norming* and zeroing the outer blocks (with order based on the desired outcome)</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">// These loops aren&#39;t parallelised, since they could have 1 or 2 iterations and will prevent</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">// inner parallelisation</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span> (outerBit == outcome) {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerDubBlockInd = 0; outerDubBlockInd &lt; numOuterDoubleBlocks; outerDubBlockInd++) {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            firstBlockInd = outerDubBlockInd*2*outerBlockSize;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            </div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="comment">// *norm only the desired inner blocks in the desired outer block</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                qureg, totalStateProb, innerBit==outcome, </div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                firstBlockInd, outerBlockSize, innerBlockSize);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            </div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="comment">// zero the undesired outer block</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, firstBlockInd + outerBlockSize, outerBlockSize);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerDubBlockInd = 0; outerDubBlockInd &lt; numOuterDoubleBlocks; outerDubBlockInd++) {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            firstBlockInd = outerDubBlockInd*2*outerBlockSize;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            </div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <span class="comment">// same thing but undesired outer blocks come first</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, firstBlockInd, outerBlockSize);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                qureg, totalStateProb, innerBit==outcome, </div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                firstBlockInd + outerBlockSize, outerBlockSize, innerBlockSize);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        }</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    </div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a031a99b7e97779f3dc782feffe86e779"><div class="ttname"><a href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a></div><div class="ttdeci">void normaliseSomeAmps(Qureg qureg, qreal norm, long long int startInd, long long int numAmps)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00808">QuEST_cpu.c:808</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_ac5168399122f7f53977dcc9ceda4f458"><div class="ttname"><a href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a></div><div class="ttdeci">void zeroSomeAmps(Qureg qureg, long long int startInd, long long int numAmps)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00798">QuEST_cpu.c:798</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a0abdff5f6065f9d57065345e6d90fc94"><div class="ttname"><a href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a></div><div class="ttdeci">void alternateNormZeroingSomeAmpBlocks(Qureg qureg, qreal norm, int normFirst, long long int startAmpInd, long long int numAmps, long long int blockSize)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00818">QuEST_cpu.c:818</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a101e7ef38c5d654a697dafe14562dcee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a101e7ef38c5d654a697dafe14562dcee">&#9670;&nbsp;</a></span>densmatr_findProbabilityOfZeroLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03146">3146</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01261">densmatr_calcProbOfOutcome()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;                                                                               {</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    </div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;    <span class="comment">// computes first local index containing a diagonal element</span></div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localNumAmps = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityDim = (1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> diagSpacing = 1LL + densityDim;</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> maxNumDiagsPerChunk = 1 + localNumAmps / diagSpacing;</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numPrevDiags = (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>&gt;0)? 1+(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*localNumAmps)/diagSpacing : 0;</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndNextDiag = diagSpacing * numPrevDiags;</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localIndNextDiag = globalIndNextDiag % localNumAmps;</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    </div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;    <span class="comment">// computes how many diagonals are contained in this chunk</span></div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numDiagsInThisChunk = maxNumDiagsPerChunk;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    <span class="keywordflow">if</span> (localIndNextDiag + (numDiagsInThisChunk-1)*diagSpacing &gt;= localNumAmps)</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        numDiagsInThisChunk -= 1;</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;    </div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> visitedDiags;     <span class="comment">// number of visited diagonals in this chunk so far</span></div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> basisStateInd;    <span class="comment">// current diagonal index being considered</span></div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;            <span class="comment">// index in the local chunk</span></div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    </div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> zeroProb = 0;</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;    </div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;<span class="preprocessor">    shared    (localIndNextDiag, numPrevDiags, diagSpacing, stateVecReal, numDiagsInThisChunk) \</span></div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="preprocessor">    private   (visitedDiags, basisStateInd, index) \</span></div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="preprocessor">    reduction ( +:zeroProb )</span></div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;    {</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        <span class="comment">// sums the diagonal elems of the density matrix where measureQubit=0</span></div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;        <span class="keywordflow">for</span> (visitedDiags = 0; visitedDiags &lt; numDiagsInThisChunk; visitedDiags++) {</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;            </div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;            basisStateInd = numPrevDiags + visitedDiags;</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;            index = localIndNextDiag + diagSpacing * visitedDiags;</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    </div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(measureQubit, basisStateInd) == 0)</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;                zeroProb += stateVecReal[index]; <span class="comment">// assume imag[diagonls] ~ 0</span></div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        }</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    }</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    </div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    <span class="keywordflow">return</span> zeroProb;</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a20a155f53efc45c16803d7539c2c199d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20a155f53efc45c16803d7539c2c199d">&#9670;&nbsp;</a></span>densmatr_initClassicalState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>stateInd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01147">1147</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;{</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityNumElems = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">// initialise the state to all zeros</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="preprocessor">    shared   (densityNumElems, densityReal, densityImag) \</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;densityNumElems; index++) {</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            densityReal[index] = 0.0;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            densityImag[index] = 0.0;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        }</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    }</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    </div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="comment">// index of the single density matrix elem to set non-zero</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityDim = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityInd = (densityDim + 1)*stateInd;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// give the specified classical state prob 1</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> == densityInd / densityNumElems){</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        densityReal[densityInd % densityNumElems] = 1.0;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        densityImag[densityInd % densityNumElems] = 0.0;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5b2ac0b00afa495f385520b2c5fa839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5b2ac0b00afa495f385520b2c5fa839">&#9670;&nbsp;</a></span>densmatr_initPlusState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initPlusState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01186">1186</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;{</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="comment">// |+&gt;&lt;+| = sum_i 1/sqrt(2^N) |i&gt; 1/sqrt(2^N) &lt;j| = sum_ij 1/2^N |i&gt;&lt;j|</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dim = (1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> probFactor = 1.0/((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>) dim);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="comment">// initialise the state to |+++..+++&gt; = 1/normFactor {1, 1, 1, ...}</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="preprocessor">    shared   (chunkSize, densityReal, densityImag, probFactor) \</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    {</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            densityReal[index] = probFactor;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;            densityImag[index] = 0.0;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        }</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    }</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b36518c8fbbc3a5084bb4ad1fb05ea5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b36518c8fbbc3a5084bb4ad1fb05ea5">&#9670;&nbsp;</a></span>densmatr_initPureStateLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initPureStateLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>targetQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>copyQureg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01216">1216</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00114">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00123">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00434">densmatr_initPureState()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                                                     {</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    </div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="comment">/* copyQureg amps aren&#39;t explicitly used - they&#39;re accessed through targetQureg.pair,</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">     * which contains the full pure statevector.</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">     * targetQureg has as many columns on node as copyQureg has amps</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    </div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> colOffset = targetQureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * copyQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> colsPerNode = copyQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> rowsPerNode = copyQureg.<a class="code" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a>;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    </div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="comment">// unpack vars for OpenMP</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecRe = targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecIm = targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* densRe = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* densIm = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    </div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> col, row, index;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    </div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="comment">// a_i conj(a_j) |i&gt;&lt;j|</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> ketRe, ketIm, braRe, braIm;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    </div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="preprocessor">    shared   (colOffset, colsPerNode,rowsPerNode, vecRe,vecIm,densRe,densIm) \</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="preprocessor">    private  (col,row, ketRe,ketIm,braRe,braIm, index) </span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    {</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="comment">// local column</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="keywordflow">for</span> (col=0; col &lt; colsPerNode; col++) {</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        </div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            <span class="comment">// global row</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            <span class="keywordflow">for</span> (row=0; row &lt; rowsPerNode; row++) {</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            </div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                <span class="comment">// get pure state amps</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                ketRe = vecRe[row];</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                ketIm = vecIm[row];</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                braRe =   vecRe[col + colOffset];</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                braIm = - vecIm[col + colOffset]; <span class="comment">// minus for conjugation</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            </div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                <span class="comment">// update density matrix</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                index = row + col*rowsPerNode; <span class="comment">// local ind</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                densRe[index] = ketRe*braRe - ketIm*braIm;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                densIm[index] = ketRe*braIm + ketIm*braRe;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            }</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        }</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    }</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_adef4935cac95763c29164cf99b144ed4"><div class="ttname"><a href="structQureg.html#adef4935cac95763c29164cf99b144ed4">Qureg::numAmpsTotal</a></div><div class="ttdeci">long long int numAmpsTotal</div><div class="ttdoc">Total number of amplitudes, which are possibly distributed among machines. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00114">QuEST.h:114</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00123">QuEST.h:123</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5531686f00049314901f17a0e03f5979"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5531686f00049314901f17a0e03f5979">&#9670;&nbsp;</a></span>densmatr_mixDampingDephase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDampingDephase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>dephase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00143">143</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l00107">densmatr_oneQubitDegradeOffDiagonal()</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00363">densmatr_mixDampingDistributed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                                                                   {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=sqrt(1-dephase);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="QuEST__cpu_8c.html#a4b578690aa76d1e9cac9dc964d713f38">densmatr_oneQubitDegradeOffDiagonal</a>(qureg, targetQubit, retain);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div><div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a4b578690aa76d1e9cac9dc964d713f38"><div class="ttname"><a href="QuEST__cpu_8c.html#a4b578690aa76d1e9cac9dc964d713f38">densmatr_oneQubitDegradeOffDiagonal</a></div><div class="ttdeci">void densmatr_oneQubitDegradeOffDiagonal(Qureg qureg, const int targetQubit, qreal retain)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00107">QuEST_cpu.c:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a28d2a35fde2952211f5898a76275d93d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28d2a35fde2952211f5898a76275d93d">&#9670;&nbsp;</a></span>densmatr_mixDampingDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDampingDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>damping</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00363">363</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00143">densmatr_mixDampingDephase()</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00123">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00709">densmatr_mixDamping()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                                                                       {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-damping;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase=sqrt(1-damping);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// first do dephase part. </span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// TODO -- this might be more efficient to do at the same time as the depolarise if we move to</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// iterating over all elements in the state vector for the purpose of vectorisation</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// TODO -- if we keep this split, move this function to densmatr_mixDepolarising()</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="QuEST__cpu_8c.html#a5531686f00049314901f17a0e03f5979">densmatr_mixDampingDephase</a>(qureg, targetQubit, dephase);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlock, sizeInnerHalfBlock;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterHalfColumn;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         thisOuterColumn, <span class="comment">// current column in density matrix</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;         thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;         thisIndexInOuterColumn,</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;         thisIndexInInnerBlock; </div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">int</span> outerBit; </div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordtype">int</span> stateBit;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    sizeInnerHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    sizeInnerBlock = 2LL * sizeInnerHalfBlock; </div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    sizeOuterHalfColumn = sizeOuterColumn &gt;&gt; 1;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">    shared   (sizeInnerBlock,sizeInnerHalfBlock,sizeOuterColumn,sizeOuterHalfColumn,qureg,damping, retain, dephase) \</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="preprocessor">    private  (thisTask,thisInnerBlock,thisOuterColumn,thisIndex,thisIndexInOuterColumn, \</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">                thisIndexInInnerBlock,outerBit, stateBit) </span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment">// thisTask iterates over half the elements in this process&#39; chunk of the density matrix</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="comment">// within one column.</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="comment">// If this function has been called, this process&#39; chunk contains half an </span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="comment">// outer block or less</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="comment">// we want to process all columns in the density matrix,</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="comment">// updating the values for half of each column (one half of each inner block)</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            thisOuterColumn = thisTask / sizeOuterHalfColumn;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            thisIndexInOuterColumn = thisTask&amp;(sizeOuterHalfColumn-1); <span class="comment">// thisTask % sizeOuterHalfColumn</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            thisInnerBlock = thisIndexInOuterColumn/sizeInnerHalfBlock;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="comment">// get index in state vector corresponding to upper inner block</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            thisIndexInInnerBlock = thisTask&amp;(sizeInnerHalfBlock-1); <span class="comment">// thisTask % sizeInnerHalfBlock</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlock*sizeInnerBlock </div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                + thisIndexInInnerBlock;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="comment">// check if we are in the upper or lower half of an outer block</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            outerBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            thisIndex += outerBit*(sizeInnerHalfBlock);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="comment">// dephase in the chunk of the state vector on this process, in the </span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="comment">// density matrix representation. </span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="comment">// thisTask is the index of the pair element in pairStateVec</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="comment">// Extract state bit, is 0 if thisIndex corresponds to a state with 0 in the target qubit</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="comment">// and is 1 if thisIndex corresponds to a state with 1 in the target qubit</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            stateBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>));</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;           </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="comment">//      + pair[thisTask])/2</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="keywordflow">if</span>(stateBit == 0){</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] +</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    damping*( qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real[thisTask]);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                </div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] +</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                    damping*( qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag[thisTask]);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            } <span class="keywordflow">else</span>{</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex];</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            </div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex];</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        } </div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }    </div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a5531686f00049314901f17a0e03f5979"><div class="ttname"><a href="QuEST__cpu_8c.html#a5531686f00049314901f17a0e03f5979">densmatr_mixDampingDephase</a></div><div class="ttdeci">void densmatr_mixDampingDephase(Qureg qureg, const int targetQubit, qreal dephase)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00143">QuEST_cpu.c:143</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00123">QuEST.h:123</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cc805451304b8ad4429c7107f90ab3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cc805451304b8ad4429c7107f90ab3b">&#9670;&nbsp;</a></span>densmatr_mixDampingLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDampingLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>damping</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00238">238</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00709">densmatr_mixDamping()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                                                                 {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-damping;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase=sqrt(retain);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMask = 1LL &lt;&lt; targetQubit;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMask = 1LL &lt;&lt; (targetQubit + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMask = innerMask|outerMask;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPattern;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">//qreal realAv, imagAv;</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        </div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">    shared   (innerMask,outerMask,totMask,qureg,retain,damping,dephase) \</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">    private  (thisTask,partner,thisPattern) </span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            thisPattern = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMask;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordflow">if</span> ((thisPattern==innerMask) || (thisPattern==outerMask)){</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="comment">// do dephase</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = dephase*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask]; </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = dephase*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask]; </div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keywordflow">if</span> ((thisTask&amp;totMask)==0){ <span class="comment">//this element relates to targetQubit in state 0</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    <span class="comment">// do depolarise</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    partner = thisTask | totMask;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    <span class="comment">//realAv =  (qureg.stateVec.real[thisTask] + qureg.stateVec.real[partner]) /2 ;</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    <span class="comment">//imagAv =  (qureg.stateVec.imag[thisTask] + qureg.stateVec.imag[partner]) /2 ;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    </div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] + damping*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner];</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] + damping*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner];</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    </div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner];</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner];</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }  </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8adaba9dbdad6f7ab41ae4b8db0abefe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8adaba9dbdad6f7ab41ae4b8db0abefe">&#9670;&nbsp;</a></span>densmatr_mixDensityMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDensityMatrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>combineQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>otherProb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>otherQureg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00954">954</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                                                                      {</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    </div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="comment">/* corresponding amplitudes live on the same node (same dimensions) */</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    </div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="comment">// unpack vars for OpenMP</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* combineVecRe = combineQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* combineVecIm = combineQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* otherVecRe = otherQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* otherVecIm = otherQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = combineQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    </div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="preprocessor">    default (none) \</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="preprocessor">    shared  (combineVecRe,combineVecIm,otherVecRe,otherVecIm, otherProb, numAmps) \</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="preprocessor">    private (index)</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">for</span> (index=0; index &lt; numAmps; index++) {</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            combineVecRe[index] *= 1-otherProb;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            combineVecIm[index] *= 1-otherProb;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            </div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            combineVecRe[index] += otherProb * otherVecRe[index];</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            combineVecIm[index] += otherProb * otherVecIm[index];</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        }</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a515b6a920b1715d4eae25dcf29f39b95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a515b6a920b1715d4eae25dcf29f39b95">&#9670;&nbsp;</a></span>densmatr_mixDephasing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDephasing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>dephase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00138">138</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l00107">densmatr_oneQubitDegradeOffDiagonal()</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00288">densmatr_mixDepolarisingDistributed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                                                              {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-dephase;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="QuEST__cpu_8c.html#a4b578690aa76d1e9cac9dc964d713f38">densmatr_oneQubitDegradeOffDiagonal</a>(qureg, targetQubit, retain);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div><div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a4b578690aa76d1e9cac9dc964d713f38"><div class="ttname"><a href="QuEST__cpu_8c.html#a4b578690aa76d1e9cac9dc964d713f38">densmatr_oneQubitDegradeOffDiagonal</a></div><div class="ttdeci">void densmatr_oneQubitDegradeOffDiagonal(Qureg qureg, const int targetQubit, qreal retain)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00107">QuEST_cpu.c:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc485aea8dccf1678f80fa9c5df6724a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc485aea8dccf1678f80fa9c5df6724a">&#9670;&nbsp;</a></span>densmatr_mixDepolarisingDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDepolarisingDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>depolLevel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00288">288</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00138">densmatr_mixDephasing()</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00123">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00682">densmatr_mixDepolarising()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                                                                               {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// first do dephase part. </span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// TODO -- this might be more efficient to do at the same time as the depolarise if we move to</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// iterating over all elements in the state vector for the purpose of vectorisation</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// TODO -- if we keep this split, move this function to densmatr_mixDepolarising()</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="QuEST__cpu_8c.html#a515b6a920b1715d4eae25dcf29f39b95">densmatr_mixDephasing</a>(qureg, targetQubit, depolLevel);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlock, sizeInnerHalfBlock;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterHalfColumn;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;         thisOuterColumn, <span class="comment">// current column in density matrix</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;         thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;         thisIndexInOuterColumn,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;         thisIndexInInnerBlock; </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">int</span> outerBit; </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    sizeInnerHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    sizeInnerBlock = 2LL * sizeInnerHalfBlock; </div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    sizeOuterHalfColumn = sizeOuterColumn &gt;&gt; 1;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">    shared   (sizeInnerBlock,sizeInnerHalfBlock,sizeOuterColumn,sizeOuterHalfColumn,qureg,depolLevel) \</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">    private  (thisTask,thisInnerBlock,thisOuterColumn,thisIndex,thisIndexInOuterColumn, \</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor">                thisIndexInInnerBlock,outerBit) </span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// thisTask iterates over half the elements in this process&#39; chunk of the density matrix</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">// within one column.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">// If this function has been called, this process&#39; chunk contains half an </span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="comment">// outer block or less</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="comment">// we want to process all columns in the density matrix,</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="comment">// updating the values for half of each column (one half of each inner block)</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            thisOuterColumn = thisTask / sizeOuterHalfColumn;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            thisIndexInOuterColumn = thisTask&amp;(sizeOuterHalfColumn-1); <span class="comment">// thisTask % sizeOuterHalfColumn</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            thisInnerBlock = thisIndexInOuterColumn/sizeInnerHalfBlock;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="comment">// get index in state vector corresponding to upper inner block</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            thisIndexInInnerBlock = thisTask&amp;(sizeInnerHalfBlock-1); <span class="comment">// thisTask % sizeInnerHalfBlock</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlock*sizeInnerBlock </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                + thisIndexInInnerBlock;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="comment">// check if we are in the upper or lower half of an outer block</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            outerBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            thisIndex += outerBit*(sizeInnerHalfBlock);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="comment">// dephase in the chunk of the state vector on this process, in the </span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="comment">// density matrix representation. </span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="comment">// thisTask is the index of the pair element in pairStateVec</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;           </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="comment">//      + pair[thisTask])/2</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] = (1-depolLevel)*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] +</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    depolLevel*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] + qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real[thisTask])/2;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            </div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] = (1-depolLevel)*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] +</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    depolLevel*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] + qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag[thisTask])/2;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        } </div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }    </div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a515b6a920b1715d4eae25dcf29f39b95"><div class="ttname"><a href="QuEST__cpu_8c.html#a515b6a920b1715d4eae25dcf29f39b95">densmatr_mixDephasing</a></div><div class="ttdeci">void densmatr_mixDephasing(Qureg qureg, const int targetQubit, qreal dephase)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00138">QuEST_cpu.c:138</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00123">QuEST.h:123</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1807899a1c39506427433739562670ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1807899a1c39506427433739562670ec">&#9670;&nbsp;</a></span>densmatr_mixDepolarisingLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDepolarisingLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>depolLevel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00189">189</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00682">densmatr_mixDepolarising()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                                                                         {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-depolLevel;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMask = 1LL &lt;&lt; targetQubit;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMask = 1LL &lt;&lt; (targetQubit + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMask = innerMask|outerMask;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPattern;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> realAv, imagAv;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        </div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">    shared   (innerMask,outerMask,totMask,qureg,retain,depolLevel) \</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">    private  (thisTask,partner,thisPattern,realAv,imagAv) </span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            thisPattern = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMask;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordflow">if</span> ((thisPattern==innerMask) || (thisPattern==outerMask)){</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="comment">// do dephase</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask]; </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask]; </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">if</span> ((thisTask&amp;totMask)==0){ <span class="comment">//this element relates to targetQubit in state 0</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    <span class="comment">// do depolarise</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    partner = thisTask | totMask;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    realAv =  (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] + qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner]) /2 ;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    imagAv =  (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] + qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner]) /2 ;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] + depolLevel*realAv;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] + depolLevel*imagAv;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] + depolLevel*realAv;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] + depolLevel*imagAv;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }  </div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5090b080392ab9be8fcf538161d4e5c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5090b080392ab9be8fcf538161d4e5c1">&#9670;&nbsp;</a></span>densmatr_mixTwoQubitDephasing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixTwoQubitDephasing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>dephase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00148">148</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                                                                                   {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-dephase;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1 = 1LL &lt;&lt; (qubit1 + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1|outerMaskQubit1;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2|outerMaskQubit2;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">    shared   (innerMaskQubit1,outerMaskQubit1,totMaskQubit1,innerMaskQubit2,outerMaskQubit2, \</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">                totMaskQubit2,qureg,retain) \</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">    private  (thisTask,thisPatternQubit1,thisPatternQubit2) </span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            </div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="comment">// any mismatch |...0...&gt;&lt;...1...| etc</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">if</span> ( (thisPatternQubit1==innerMaskQubit1) || (thisPatternQubit1==outerMaskQubit1) || </div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                    (thisPatternQubit2==innerMaskQubit2) || (thisPatternQubit2==outerMaskQubit2) ){ </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="comment">// do dephase</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask]; </div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask]; </div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            } </div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }  </div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac497197e66d7024fc6bf7ace120b3de5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac497197e66d7024fc6bf7ace120b3de5">&#9670;&nbsp;</a></span>densmatr_mixTwoQubitDepolarisingDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixTwoQubitDepolarisingDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>gamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00605">605</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00123">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00736">densmatr_mixTwoQubitDepolarising()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                                                    {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ1, sizeInnerHalfBlockQ1;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ2, sizeInnerHalfBlockQ2, sizeInnerQuarterBlockQ2;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterQuarterColumn;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlockQ2,</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;         thisOuterColumn, <span class="comment">// current column in density matrix</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;         thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;         thisIndexInOuterColumn,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;         thisIndexInInnerBlockQ1, </div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;         thisIndexInInnerBlockQ2, </div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;         thisInnerBlockQ1InInnerBlockQ2;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordtype">int</span> outerBitQ1, outerBitQ2; </div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;2;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    sizeInnerHalfBlockQ1 = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    sizeInnerHalfBlockQ2 = 1LL &lt;&lt; qubit2;  </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    sizeInnerQuarterBlockQ2 = sizeInnerHalfBlockQ2 &gt;&gt; 1;  </div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    sizeInnerBlockQ2 = sizeInnerHalfBlockQ2 &lt;&lt; 1;  </div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    sizeInnerBlockQ1 = 2LL * sizeInnerHalfBlockQ1; </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    sizeOuterQuarterColumn = sizeOuterColumn &gt;&gt; 2;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor">    shared   (sizeInnerBlockQ1,sizeInnerHalfBlockQ1,sizeInnerBlockQ2,sizeInnerHalfBlockQ2,sizeInnerQuarterBlockQ2,\</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor">                sizeOuterColumn,sizeOuterQuarterColumn,qureg,delta,gamma) \</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="preprocessor">    private  (thisTask,thisInnerBlockQ2,thisInnerBlockQ1InInnerBlockQ2, \</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor">                thisOuterColumn,thisIndex,thisIndexInOuterColumn, \</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor">                thisIndexInInnerBlockQ1,thisIndexInInnerBlockQ2,outerBitQ1,outerBitQ2) </span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="comment">// thisTask iterates over half the elements in this process&#39; chunk of the density matrix</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="comment">// within one column.</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="comment">// If this function has been called, this process&#39; chunk contains half an </span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="comment">// outer block or less</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="comment">// we want to process all columns in the density matrix,</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="comment">// updating the values for half of each column (one half of each inner block)</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            thisOuterColumn = thisTask / sizeOuterQuarterColumn;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="comment">// thisTask % sizeOuterQuarterColumn</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            thisIndexInOuterColumn = thisTask&amp;(sizeOuterQuarterColumn-1); </div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            thisInnerBlockQ2 = thisIndexInOuterColumn / sizeInnerQuarterBlockQ2;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="comment">// thisTask % sizeInnerQuarterBlockQ2;</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            thisIndexInInnerBlockQ2 = thisTask&amp;(sizeInnerQuarterBlockQ2-1);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            thisInnerBlockQ1InInnerBlockQ2 = thisIndexInInnerBlockQ2 / sizeInnerHalfBlockQ1;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="comment">// thisTask % sizeInnerHalfBlockQ1;</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            thisIndexInInnerBlockQ1 = thisTask&amp;(sizeInnerHalfBlockQ1-1);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="comment">// get index in state vector corresponding to upper inner block</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlockQ2*sizeInnerBlockQ2 </div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                + thisInnerBlockQ1InInnerBlockQ2*sizeInnerBlockQ1 + thisIndexInInnerBlockQ1;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="comment">// check if we are in the upper or lower half of an outer block for Q1</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            outerBitQ1 = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            thisIndex += outerBitQ1*(sizeInnerHalfBlockQ1);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="comment">// check if we are in the upper or lower half of an outer block for Q2</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            outerBitQ2 = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(qubit2, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            thisIndex += outerBitQ2*(sizeInnerQuarterBlockQ2&lt;&lt;1);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="comment">// dephase in the chunk of the state vector on this process, in the </span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="comment">// density matrix representation. </span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="comment">// thisTask is the index of the pair element in pairStateVec</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;           </div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="comment">//      + pair[thisTask])/2</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <span class="comment">// NOTE: must set gamma=1 if using this function for steps 1 or 2</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] = gamma*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] +</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                    delta*qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real[thisTask]);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] = gamma*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] +</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    delta*qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag[thisTask]);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        } </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }    </div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00123">QuEST.h:123</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3510f01d4d15dcc545564eb84c668cad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3510f01d4d15dcc545564eb84c668cad">&#9670;&nbsp;</a></span>densmatr_mixTwoQubitDepolarisingLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixTwoQubitDepolarisingLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>gamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00450">450</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00736">densmatr_mixTwoQubitDepolarising()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                                                                                          {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1= 1LL &lt;&lt; (qubit1 + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1 | outerMaskQubit1;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2 | outerMaskQubit2;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> real00, imag00;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor">    shared   (totMaskQubit1,totMaskQubit2,qureg,delta,gamma) \</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">    private  (thisTask,partner,thisPatternQubit1,thisPatternQubit2,real00,imag00) </span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="comment">//--------------------------------------- STEP ONE ---------------------</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){ </div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordflow">if</span> ((thisPatternQubit1==0) &amp;&amp; ((thisPatternQubit2==0) </div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                        || (thisPatternQubit2==totMaskQubit2))){ </div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <span class="comment">//this element of form |...X...0...&gt;&lt;...X...0...|  for X either 0 or 1.</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                partner = thisTask | totMaskQubit1;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                real00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask];</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                imag00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask];</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    </div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] </div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner];</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] </div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner];</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                    </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] + delta*real00;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] + delta*imag00;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                </div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment">//--------------------------------------- STEP TWO ---------------------</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){ </div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keywordflow">if</span> ((thisPatternQubit2==0) &amp;&amp; ((thisPatternQubit1==0) </div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                        || (thisPatternQubit1==totMaskQubit1))){ </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <span class="comment">//this element of form |...0...X...&gt;&lt;...0...X...|  for X either 0 or 1.</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                partner = thisTask | totMaskQubit2;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                real00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask];</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                imag00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask];</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    </div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] </div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner];</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner];</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    </div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] + delta*real00;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] + delta*imag00;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">//--------------------------------------- STEP THREE ---------------------</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){ </div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">if</span> ((thisPatternQubit2==0) &amp;&amp; ((thisPatternQubit1==0) </div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        || (thisPatternQubit1==totMaskQubit1))){ </div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                <span class="comment">//this element of form |...0...X...&gt;&lt;...0...X...|  for X either 0 or 1.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                partner = thisTask | totMaskQubit2;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                partner = partner ^ totMaskQubit1;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                real00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask];</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                imag00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask];</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = gamma * (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] </div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner]);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = gamma * (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] </div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                        + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner]);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    </div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = gamma * (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        + delta*real00);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = gamma * (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                        + delta*imag00);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae90f82418e0aa67218d733dbbc681998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae90f82418e0aa67218d733dbbc681998">&#9670;&nbsp;</a></span>densmatr_mixTwoQubitDepolarisingLocalPart1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixTwoQubitDepolarisingLocalPart1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00552">552</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00736">densmatr_mixTwoQubitDepolarising()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                                                                                  {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1= 1LL &lt;&lt; (qubit1 + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1 | outerMaskQubit1;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2 | outerMaskQubit2;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">// correct for being in a particular chunk</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">//totMaskQubit2 = totMaskQubit2&amp;(qureg.numAmpsPerChunk-1); // totMaskQubit2 % numAmpsPerChunk</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    </div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> real00, imag00;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="preprocessor">    shared   (totMaskQubit1,totMaskQubit2,qureg,delta) \</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor">    private  (thisTask,partner,thisPatternQubit1,thisPatternQubit2,real00,imag00) </span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="comment">//--------------------------------------- STEP ONE ---------------------</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask ++){ </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="keywordflow">if</span> ((thisPatternQubit1==0) &amp;&amp; ((thisPatternQubit2==0) </div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                        || (thisPatternQubit2==totMaskQubit2))){ </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <span class="comment">//this element of form |...X...0...&gt;&lt;...X...0...|  for X either 0 or 1.</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                partner = thisTask | totMaskQubit1;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                real00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask];</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                imag00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask];</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                    </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] </div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner];</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner];</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                    </div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] + delta*real00;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] + delta*imag00;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af82f6c9317f51a2048ddd3eb24c2959c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af82f6c9317f51a2048ddd3eb24c2959c">&#9670;&nbsp;</a></span>densmatr_mixTwoQubitDepolarisingQ1LocalQ2DistributedPart3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixTwoQubitDepolarisingQ1LocalQ2DistributedPart3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>gamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00696">696</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00123">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00736">densmatr_mixTwoQubitDepolarising()</a>, and <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>.</p>
<div class="fragment"><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                                    {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ1, sizeInnerHalfBlockQ1;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ2, sizeInnerHalfBlockQ2, sizeInnerQuarterBlockQ2;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterQuarterColumn;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlockQ2,</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;         thisOuterColumn, <span class="comment">// current column in density matrix</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;         thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;         thisIndexInPairVector,</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;         thisIndexInOuterColumn,</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;         thisIndexInInnerBlockQ1, </div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;         thisIndexInInnerBlockQ2, </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;         thisInnerBlockQ1InInnerBlockQ2;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordtype">int</span> outerBitQ1, outerBitQ2; </div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;2;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    sizeInnerHalfBlockQ1 = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    sizeInnerHalfBlockQ2 = 1LL &lt;&lt; qubit2;  </div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    sizeInnerQuarterBlockQ2 = sizeInnerHalfBlockQ2 &gt;&gt; 1;  </div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    sizeInnerBlockQ2 = sizeInnerHalfBlockQ2 &lt;&lt; 1;  </div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    sizeInnerBlockQ1 = 2LL * sizeInnerHalfBlockQ1; </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    sizeOuterQuarterColumn = sizeOuterColumn &gt;&gt; 2;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">//# if 0</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="preprocessor">    shared   (sizeInnerBlockQ1,sizeInnerHalfBlockQ1,sizeInnerBlockQ2,sizeInnerHalfBlockQ2,sizeInnerQuarterBlockQ2,\</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor">                sizeOuterColumn,sizeOuterQuarterColumn,qureg,delta,gamma) \</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="preprocessor">    private  (thisTask,thisInnerBlockQ2,thisInnerBlockQ1InInnerBlockQ2, \</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor">                thisOuterColumn,thisIndex,thisIndexInPairVector,thisIndexInOuterColumn, \</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="preprocessor">                thisIndexInInnerBlockQ1,thisIndexInInnerBlockQ2,outerBitQ1,outerBitQ2) </span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">//# endif</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="comment">// thisTask iterates over half the elements in this process&#39; chunk of the density matrix</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="comment">// within one column.</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="comment">// If this function has been called, this process&#39; chunk contains half an </span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="comment">// outer block or less</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="comment">// we want to process all columns in the density matrix,</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="comment">// updating the values for half of each column (one half of each inner block)</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            thisOuterColumn = thisTask / sizeOuterQuarterColumn;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="comment">// thisTask % sizeOuterQuarterColumn</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            thisIndexInOuterColumn = thisTask&amp;(sizeOuterQuarterColumn-1); </div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            thisInnerBlockQ2 = thisIndexInOuterColumn / sizeInnerQuarterBlockQ2;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="comment">// thisTask % sizeInnerQuarterBlockQ2;</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            thisIndexInInnerBlockQ2 = thisTask&amp;(sizeInnerQuarterBlockQ2-1);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            thisInnerBlockQ1InInnerBlockQ2 = thisIndexInInnerBlockQ2 / sizeInnerHalfBlockQ1;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="comment">// thisTask % sizeInnerHalfBlockQ1;</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            thisIndexInInnerBlockQ1 = thisTask&amp;(sizeInnerHalfBlockQ1-1);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="comment">// get index in state vector corresponding to upper inner block</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlockQ2*sizeInnerBlockQ2 </div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                + thisInnerBlockQ1InInnerBlockQ2*sizeInnerBlockQ1 + thisIndexInInnerBlockQ1;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="comment">// check if we are in the upper or lower half of an outer block for Q1</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            outerBitQ1 = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            thisIndex += outerBitQ1*(sizeInnerHalfBlockQ1);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            </div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="comment">// For part 3 we need to match elements such that (my Q1 != pair Q1) AND (my Q2 != pair Q2)</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="comment">// Find correct index in pairStateVector</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            thisIndexInPairVector = thisTask + (1-outerBitQ1)*sizeInnerHalfBlockQ1*sizeOuterQuarterColumn -</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                outerBitQ1*sizeInnerHalfBlockQ1*sizeOuterQuarterColumn;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            </div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="comment">// check if we are in the upper or lower half of an outer block for Q2</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            outerBitQ2 = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(qubit2, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            thisIndex += outerBitQ2*(sizeInnerQuarterBlockQ2&lt;&lt;1);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            </div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            </div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="comment">// dephase in the chunk of the state vector on this process, in the </span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="comment">// density matrix representation. </span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;           </div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="comment">//      + pair[thisIndexInPairVector])/2</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] = gamma*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] +</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    delta*qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real[thisIndexInPairVector]);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            </div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] = gamma*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] +</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    delta*qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag[thisIndexInPairVector]);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        } </div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    }    </div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00123">QuEST.h:123</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b578690aa76d1e9cac9dc964d713f38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b578690aa76d1e9cac9dc964d713f38">&#9670;&nbsp;</a></span>densmatr_oneQubitDegradeOffDiagonal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_oneQubitDegradeOffDiagonal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>retain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00107">107</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::numQubitsRepresented</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00143">densmatr_mixDampingDephase()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00138">densmatr_mixDephasing()</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                                                                          {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMask = 1LL &lt;&lt; targetQubit;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMask = 1LL &lt;&lt; (targetQubit + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPattern;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMask = innerMask|outerMask;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor"> # ifdef _OPENMP</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">    shared   (innerMask,outerMask,totMask,qureg,retain) \</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">    private  (thisTask,thisPattern) </span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            thisPattern = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMask;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">if</span> ((thisPattern==innerMask) || (thisPattern==outerMask)){</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="comment">// do dephase</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask]; </div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask]; </div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            } </div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }  </div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00107">QuEST.h:107</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59a3d13a0da8e43b83660b1f972a3116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a3d13a0da8e43b83660b1f972a3116">&#9670;&nbsp;</a></span>destroyDiagonalOperator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyDiagonalOperator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOperator.html">DiagonalOperator</a>&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroys a <a class="el" href="structDiagonalOperator.html" title="Represents a diagonal compelx operator on the full Hilbert state of a Qureg. ">DiagonalOperator</a>, freeing CPU and (if allocated) GPU memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">op</td><td>an instantiated operator created with createDiagonalOperator </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00057">57</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                                  {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    free(op.<a class="code" href="structDiagonalOperator.html#a1e3d52728cd3f9fafff974ce4c6ea7e0">real</a>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    free(op.<a class="code" href="structDiagonalOperator.html#ac4f9117b53a278326df27dea6a90f335">imag</a>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div><div class="ttc" id="structDiagonalOperator_html_a1e3d52728cd3f9fafff974ce4c6ea7e0"><div class="ttname"><a href="structDiagonalOperator.html#a1e3d52728cd3f9fafff974ce4c6ea7e0">DiagonalOperator::real</a></div><div class="ttdeci">qreal * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00155">QuEST.h:155</a></div></div>
<div class="ttc" id="structDiagonalOperator_html_ac4f9117b53a278326df27dea6a90f335"><div class="ttname"><a href="structDiagonalOperator.html#ac4f9117b53a278326df27dea6a90f335">DiagonalOperator::imag</a></div><div class="ttdeci">qreal * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00156">QuEST.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a37e522505286f17fe6ef74b9f607a5c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37e522505286f17fe6ef74b9f607a5c6">&#9670;&nbsp;</a></span>getBitMaskParity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getBitMaskParity </td>
          <td>(</td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>mask</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03095">3095</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l03104">statevec_multiRotateZ()</a>.</p>
<div class="fragment"><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;                                         {</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <span class="keywordtype">int</span> parity = 0;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="keywordflow">while</span> (mask) {</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;        parity = !parity;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;        mask = mask &amp; (mask-1);</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    }</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="keywordflow">return</span> parity;</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a031a99b7e97779f3dc782feffe86e779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a031a99b7e97779f3dc782feffe86e779">&#9670;&nbsp;</a></span>normaliseSomeAmps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normaliseSomeAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>norm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00808">808</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00818">alternateNormZeroingSomeAmpBlocks()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00849">densmatr_collapseToKnownProbOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                                                                                               {</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor"># pragma omp parallel for schedule (static)</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">for</span> (i=startInd; i &lt; startInd+numAmps; i++) {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] /= norm;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i] /= norm;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa4231f79fe9498e4fd87cc70cde5a9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa4231f79fe9498e4fd87cc70cde5a9d">&#9670;&nbsp;</a></span>qsortComp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int qsortComp </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01843">1843</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l01847">statevec_multiControlledMultiQubitUnitaryLocal()</a>.</p>
<div class="fragment"><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                                            {</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordflow">return</span> *(<span class="keywordtype">int</span>*)a - *(<span class="keywordtype">int</span>*)b; </div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a4103b0bd0dc7eaf078aa2a4e6446c89d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4103b0bd0dc7eaf078aa2a4e6446c89d">&#9670;&nbsp;</a></span>statevec_applyDiagonalOperator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_applyDiagonalOperator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDiagonalOperator.html">DiagonalOperator</a>&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00066">66</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00156">DiagonalOperator::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00155">DiagonalOperator::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                                                      {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    </div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// each node/chunk modifies only its values in an embarrassingly parallelisable way</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    </div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateRe = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateIm = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opRe = op.<a class="code" href="structDiagonalOperator.html#a1e3d52728cd3f9fafff974ce4c6ea7e0">real</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opIm = op.<a class="code" href="structDiagonalOperator.html#ac4f9117b53a278326df27dea6a90f335">imag</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    </div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> a,b,c,d;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">    shared    (stateRe,stateIm, opRe,opIm, numAmps) \</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">    private   (index, a,b,c,d)</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            a = stateRe[index];</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            b = stateIm[index];</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            c = opRe[index];</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            d = opIm[index];</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="comment">// (a + b i)(c + d i) = (a c - b d) + i (a d + b c)</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            stateRe[index] = a*c - b*d;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            stateIm[index] = a*d + b*c;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="structDiagonalOperator_html_a1e3d52728cd3f9fafff974ce4c6ea7e0"><div class="ttname"><a href="structDiagonalOperator.html#a1e3d52728cd3f9fafff974ce4c6ea7e0">DiagonalOperator::real</a></div><div class="ttdeci">qreal * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00155">QuEST.h:155</a></div></div>
<div class="ttc" id="structDiagonalOperator_html_ac4f9117b53a278326df27dea6a90f335"><div class="ttname"><a href="structDiagonalOperator.html#ac4f9117b53a278326df27dea6a90f335">DiagonalOperator::imag</a></div><div class="ttdeci">qreal * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00156">QuEST.h:156</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6fbb3b693f25dde1e9e3dc87dc1984f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fbb3b693f25dde1e9e3dc87dc1984f7">&#9670;&nbsp;</a></span>statevec_calcInnerProductLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplex.html">Complex</a> statevec_calcInnerProductLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>bra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>ket</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01103">1103</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00064">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00063">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00030">statevec_calcInnerProduct()</a>.</p>
<div class="fragment"><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                                                             {</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    </div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> innerProdReal = 0;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> innerProdImag = 0;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    </div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = bra.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *braVecReal = bra.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *braVecImag = bra.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *ketVecReal = ket.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *ketVecImag = ket.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    </div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> braRe, braIm, ketRe, ketIm;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    </div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="preprocessor">    shared    (braVecReal, braVecImag, ketVecReal, ketVecImag, numAmps) \</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">    private   (index, braRe, braIm, ketRe, ketIm) \</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor">    reduction ( +:innerProdReal, innerProdImag )</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">for</span> (index=0; index &lt; numAmps; index++) {</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            braRe = braVecReal[index];</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            braIm = braVecImag[index];</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            ketRe = ketVecReal[index];</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            ketIm = ketVecImag[index];</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            </div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            <span class="comment">// conj(bra_i) * ket_i</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            innerProdReal += braRe*ketRe + braIm*ketIm;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            innerProdImag += braRe*ketIm - braIm*ketRe;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        }</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    }</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    </div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <a class="code" href="structComplex.html">Complex</a> innerProd;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    innerProd.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = innerProdReal;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    innerProd.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = innerProdImag;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">return</span> innerProd;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00063">QuEST.h:63</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00064">QuEST.h:64</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00061">QuEST.h:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4b77089145184d990848cd66993aa8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4b77089145184d990848cd66993aa8b">&#9670;&nbsp;</a></span>statevec_cloneQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_cloneQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>targetQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>copyQureg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01507">1507</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                                             {</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    </div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="comment">// registers are equal sized, so nodes hold the same state-vector partitions</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    stateVecSize = targetQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *targetStateVecReal = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *targetStateVecImag = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *copyStateVecReal = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *copyStateVecImag = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="preprocessor">    shared   (stateVecSize, targetStateVecReal, targetStateVecImag, copyStateVecReal, copyStateVecImag) \</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    {</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            targetStateVecReal[index] = copyStateVecReal[index];</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            targetStateVecImag[index] = copyStateVecImag[index];</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        }</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    }</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd82c94cfac89eacb901348ff0d06af8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd82c94cfac89eacb901348ff0d06af8">&#9670;&nbsp;</a></span>statevec_collapseToKnownProbOutcomeDistributedRenorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToKnownProbOutcomeDistributedRenorm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>totalProbability</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that the value 'outcome' has been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles the renormalisation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totalProbability</td><td>probability of qubit measureQubit being zero </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03457">3457</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01283">statevec_collapseToKnownProbOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;{</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;    <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   </div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> renorm=1/sqrt(totalProbability);</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;<span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;<span class="preprocessor">    private   (thisTask)</span></div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;    {</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;            stateVecReal[thisTask] = stateVecReal[thisTask]*renorm;</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;            stateVecImag[thisTask] = stateVecImag[thisTask]*renorm;</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        }</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    }</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab02bce0ebbb8f624e8ced8b09b99cdef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab02bce0ebbb8f624e8ced8b09b99cdef">&#9670;&nbsp;</a></span>statevec_collapseToKnownProbOutcomeLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToKnownProbOutcomeLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>totalProbability</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. </p>
<p>Performs an irreversible change to the state vector: it updates the vector according to the event that an outcome have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1 according to the value of outcome. In the local version, one or more blocks (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) fit entirely into one chunk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totalProbability</td><td>probability of qubit measureQubit being either zero or one </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outcome</td><td>to measure the probability of and set the state to &ndash; either zero or one </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03375">3375</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01283">statevec_collapseToKnownProbOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;{</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    <span class="comment">// ----- sizes</span></div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                  <span class="comment">// size of blocks</span></div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span></div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;    <span class="comment">// ----- indices</span></div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                  <span class="comment">// current block</span></div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;         index;                                               <span class="comment">// current index for first half block</span></div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    <span class="comment">// ----- measured probability</span></div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>   renorm;                                            <span class="comment">// probability (returned) value</span></div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    <span class="comment">// (good for shared memory parallelism)</span></div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    <span class="comment">//            dimensions                                            //</span></div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span></div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;    <span class="comment">// and then the number to skip</span></div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock;                         <span class="comment">// size of blocks (pairs of measure and skip entries)</span></div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;    renorm=1/sqrt(totalProbability);</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;<span class="preprocessor">    default (none) \</span></div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;<span class="preprocessor">    shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,renorm,outcome) \</span></div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;<span class="preprocessor">    private   (thisTask,thisBlock,index)</span></div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;    {</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;        <span class="keywordflow">if</span> (outcome==0){</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;            <span class="comment">// measure qubit is 0</span></div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;                thisBlock = thisTask / sizeHalfBlock;</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                stateVecReal[index]=stateVecReal[index]*renorm;</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;                stateVecImag[index]=stateVecImag[index]*renorm;</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;                stateVecReal[index+sizeHalfBlock]=0;</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;                stateVecImag[index+sizeHalfBlock]=0;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;            }</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;            <span class="comment">// measure qubit is 1</span></div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;                thisBlock = thisTask / sizeHalfBlock;</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;                index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;                stateVecReal[index]=0;</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;                stateVecImag[index]=0;</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;                stateVecReal[index+sizeHalfBlock]=stateVecReal[index+sizeHalfBlock]*renorm;</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;                stateVecImag[index+sizeHalfBlock]=stateVecImag[index+sizeHalfBlock]*renorm;</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;            }</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;        }</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;    }</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ea68e9132ed9db9c242353a33dba2f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ea68e9132ed9db9c242353a33dba2f0">&#9670;&nbsp;</a></span>statevec_collapseToOutcomeDistributedSetZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToOutcomeDistributedSetZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set all amplitudes in one chunk to 0. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that a zero have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles setting amplitudes to 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03496">3496</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01283">statevec_collapseToKnownProbOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;{</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;    <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   </div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;    <span class="comment">//            find probability                                      //</span></div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="preprocessor">    private   (thisTask)</span></div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    {</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;            stateVecReal[thisTask] = 0;</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;            stateVecImag[thisTask] = 0;</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;        }</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;    }</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a7a35628b1c1eb47336deb9afda5b68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a7a35628b1c1eb47336deb9afda5b68">&#9670;&nbsp;</a></span>statevec_compactUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_compactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02004">2004</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00064">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00063">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00828">statevec_compactUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;{</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot1Real=rot1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot2Real=rot2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span></div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    {</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;            <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;            stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;            stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;            stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;            <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        }</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    }</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;}</div><div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00063">QuEST.h:63</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00064">QuEST.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5865e66a6e0993ae17d400c9ee0eb43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5865e66a6e0993ae17d400c9ee0eb43">&#9670;&nbsp;</a></span>statevec_compactUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_compactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01689">1689</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00064">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00063">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00828">statevec_compactUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;{</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> alphaImag=alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> betaImag=beta.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    {</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp </div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                - betaReal*stateRealLo - betaImag*stateImagLo;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp </div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                - betaReal*stateImagLo + betaImag*stateRealLo;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp </div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                + alphaReal*stateRealLo + alphaImag*stateImagLo;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp </div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                + alphaReal*stateImagLo - alphaImag*stateRealLo;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        } </div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    }</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;} </div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00063">QuEST.h:63</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00064">QuEST.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6cecbad32a03416138b321cdc1a2c33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6cecbad32a03416138b321cdc1a2c33">&#9670;&nbsp;</a></span>statevec_compareStates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_compareStates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>mq1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>mq2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>precision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01676">1676</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                                                                 {</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> diff;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize = mq1.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    </div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i=0; i&lt;chunkSize; i++){</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        diff = absReal(mq1.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] - mq2.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i]);</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        diff = absReal(mq1.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i] - mq2.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i]);</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    }</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a230eea38971f36de8f5437b1f47aaf3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a230eea38971f36de8f5437b1f47aaf3e">&#9670;&nbsp;</a></span>statevec_controlledCompactUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledCompactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02320">2320</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00064">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00063">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00904">statevec_controlledCompactUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;{</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot1Real=rot1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot2Real=rot2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span></div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span></div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    {</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            controlBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            }</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        }</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    }</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;}</div><div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00063">QuEST.h:63</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00064">QuEST.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e5527c6e144fab8062ea5296e8bdf2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e5527c6e144fab8062ea5296e8bdf2a">&#9670;&nbsp;</a></span>statevec_controlledCompactUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledCompactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02104">2104</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00064">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00063">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00904">statevec_controlledCompactUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;{</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> alphaImag=alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> betaImag=beta.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span></div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    {</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            controlBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp </div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                    - betaReal*stateRealLo - betaImag*stateImagLo;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp </div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                    - betaReal*stateImagLo + betaImag*stateRealLo;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp </div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                    + alphaReal*stateRealLo + alphaImag*stateImagLo;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp </div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                    + alphaReal*stateImagLo - alphaImag*stateRealLo;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            }</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        } </div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    }</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;} </div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00063">QuEST.h:63</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00064">QuEST.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a97f17a0969e16f9ce9b55abd46bd732a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f17a0969e16f9ce9b55abd46bd732a">&#9670;&nbsp;</a></span>statevec_controlledNotDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledNotDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk. Only perform the rotation for elements where controlQubit is one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02647">2647</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01045">statevec_controlledNot()</a>.</p>
<div class="fragment"><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;{</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span></div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="preprocessor">    private  (thisTask,controlBit)</span></div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    {</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;            controlBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                stateVecRealOut[thisTask] = stateVecRealIn[thisTask];</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                stateVecImagOut[thisTask] = stateVecImagIn[thisTask];</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            }</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;        }</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    }</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;} </div><div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a11c9685e4ad1f44cfd6243e0c4435893"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c9685e4ad1f44cfd6243e0c4435893">&#9670;&nbsp;</a></span>statevec_controlledNotLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledNotLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02585">2585</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01045">statevec_controlledNot()</a>.</p>
<div class="fragment"><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;{</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateImagUp;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit) </span></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    {</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;            controlBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                stateVecReal[indexUp] = stateVecReal[indexLo];</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;                stateVecImag[indexUp] = stateVecImag[indexLo];</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                stateVecReal[indexLo] = stateRealUp;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                stateVecImag[indexLo] = stateImagUp;</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;            }</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;        } </div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    }</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ad35691d74b79e759c0fc53862c68b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ad35691d74b79e759c0fc53862c68b5">&#9670;&nbsp;</a></span>statevec_controlledPauliYDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPauliYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>conjFac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02828">2828</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01124">statevec_controlledPauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01157">statevec_controlledPauliYConj()</a>.</p>
<div class="fragment"><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;{</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;<span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span></div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;<span class="preprocessor">    private  (thisTask,controlBit)</span></div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    {</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;            controlBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;                stateVecRealOut[thisTask] = conjFac * stateVecImagIn[thisTask];</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;                stateVecImagOut[thisTask] = conjFac * -stateVecRealIn[thisTask];</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;            }</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        }</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    }</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;} </div><div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9028deac63419d71d523f73229a7bd84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9028deac63419d71d523f73229a7bd84">&#9670;&nbsp;</a></span>statevec_controlledPauliYLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPauliYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>conjFac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02775">2775</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01124">statevec_controlledPauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01157">statevec_controlledPauliYConj()</a>.</p>
<div class="fragment"><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;{</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateImagUp;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit) </span></div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    {</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;            controlBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                <span class="comment">// update under +-{{0, -i}, {i, 0}}</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                stateVecReal[indexUp] = conjFac * stateVecImag[indexLo];</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;                stateVecImag[indexUp] = conjFac * -stateVecReal[indexLo];</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                stateVecReal[indexLo] = conjFac * -stateImagUp;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;                stateVecImag[indexLo] = conjFac * stateRealUp;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;            }</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;        } </div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    }</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c0067cb9f243ead20de7392aea328bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c0067cb9f243ead20de7392aea328bc">&#9670;&nbsp;</a></span>statevec_controlledPhaseFlip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPhaseFlip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03295">3295</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;{</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    <span class="keywordtype">int</span> bit1, bit2;</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    </div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;<span class="preprocessor"># pragma omp parallel for \</span></div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span></div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;<span class="preprocessor">    private  (index,bit1,bit2)             \</span></div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;<span class="preprocessor">    schedule (static)</span></div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        bit1 = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (idQubit1, index+chunkId*chunkSize);</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;        bit2 = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (idQubit2, index+chunkId*chunkSize);</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;        <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;            stateVecReal [index] = - stateVecReal [index];</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;            stateVecImag [index] = - stateVecImag [index];</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;        }</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    }</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adeb715f3f2c167f9bfbe92b75f5988ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeb715f3f2c167f9bfbe92b75f5988ce">&#9670;&nbsp;</a></span>statevec_controlledPhaseShift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPhaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03015">3015</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;{</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;    <span class="keywordtype">int</span> bit1, bit2;</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    </div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    </div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealLo, stateImagLo;</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = cos(angle);</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = sin(angle);</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;<span class="preprocessor"># pragma omp parallel for \</span></div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span></div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;<span class="preprocessor">    private  (index,bit1,bit2,stateRealLo,stateImagLo)             \</span></div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;<span class="preprocessor">    schedule (static)</span></div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;        bit1 = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (idQubit1, index+chunkId*chunkSize);</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;        bit2 = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (idQubit2, index+chunkId*chunkSize);</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;        <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;            </div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;            stateRealLo = stateVecReal[index];</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;            stateImagLo = stateVecImag[index];</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;            </div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;            stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;            stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  </div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        }</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    }</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab14681cbcc8f530333a9570328886b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab14681cbcc8f530333a9570328886b32">&#9670;&nbsp;</a></span>statevec_controlledUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02382">2382</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00064">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00063">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00942">statevec_controlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;{</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot1Real=rot1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot2Real=rot2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span></div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span></div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    {</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;            controlBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;                stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;                stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;                stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp </div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;                    + rot2Real*stateRealLo - rot2Imag*stateImagLo;</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp </div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                    + rot2Real*stateImagLo + rot2Imag*stateRealLo;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            }</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        }</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    }</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;}</div><div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00063">QuEST.h:63</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00064">QuEST.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0c120ac374b402c576c4b38bcda9992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0c120ac374b402c576c4b38bcda9992">&#9670;&nbsp;</a></span>statevec_controlledUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02242">2242</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00072">ComplexMatrix2::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00071">ComplexMatrix2::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00942">statevec_controlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;{</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span></div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    {</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            controlBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span></div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateImagUp </div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateImagLo;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateRealUp </div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateRealLo;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateImagUp </div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateImagLo;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateRealUp </div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateRealLo;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            }</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        } </div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    }</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a3ea98d545b67a190ee6abe936c72076f"><div class="ttname"><a href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">ComplexMatrix2::real</a></div><div class="ttdeci">qreal real[2][2]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00071">QuEST.h:71</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structComplexMatrix2_html_a3a2b60a9e00ccef054a6de3b9307c1be"><div class="ttname"><a href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">ComplexMatrix2::imag</a></div><div class="ttdeci">qreal imag[2][2]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00072">QuEST.h:72</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a365bbb1b80cb00405c8bf1a4fa1ea8e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a365bbb1b80cb00405c8bf1a4fa1ea8e5">&#9670;&nbsp;</a></span>statevec_createQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_createQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01311">1311</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::isDensityMatrix</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00114">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00118">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00109">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00141">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00123">Qureg::pairStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00140">QuESTEnv::rank</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;{</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1LL &lt;&lt; numQubits;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    </div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="keywordflow">if</span> (numAmpsPerRank &gt; SIZE_MAX) {</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        printf(<span class="stringliteral">&quot;Could not allocate memory (cannot fit numAmps into size_t)!&quot;</span>);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        exit (EXIT_FAILURE);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    }</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordtype">size_t</span> arrSize = (size_t) (numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real)));</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real = malloc(arrSize);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag = malloc(arrSize);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real = malloc(arrSize);</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag = malloc(arrSize);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    }</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">if</span> ( (!(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real) || !(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag))</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            &amp;&amp; numAmpsPerRank ) {</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        exit (EXIT_FAILURE);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    }</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordflow">if</span> ( env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1 &amp;&amp; (!(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real) || !(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag))</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            &amp;&amp; numAmpsPerRank ) {</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        exit (EXIT_FAILURE);</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    }</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a> = numQubits;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a> = numAmps;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> = numAmpsPerRank;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> = env.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a> = env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">isDensityMatrix</a> = 0;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;}</div><div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00141">QuEST.h:141</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="structQureg_html_acf78445e9435d09f44f0cc832c6aee79"><div class="ttname"><a href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">Qureg::isDensityMatrix</a></div><div class="ttdeci">int isDensityMatrix</div><div class="ttdoc">Whether this instance is a density-state representation. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00105">QuEST.h:105</a></div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00118">QuEST.h:118</a></div></div>
<div class="ttc" id="structQureg_html_adef4935cac95763c29164cf99b144ed4"><div class="ttname"><a href="structQureg.html#adef4935cac95763c29164cf99b144ed4">Qureg::numAmpsTotal</a></div><div class="ttdeci">long long int numAmpsTotal</div><div class="ttdoc">Total number of amplitudes, which are possibly distributed among machines. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00114">QuEST.h:114</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00123">QuEST.h:123</a></div></div>
<div class="ttc" id="structQuESTEnv_html_aa648bb336cf8598467cb62db00b9cee8"><div class="ttname"><a href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">QuESTEnv::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00140">QuEST.h:140</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="structQureg_html_a0a86e8a50ea8c998b4a0a6640c5a1218"><div class="ttname"><a href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">Qureg::numQubitsInStateVec</a></div><div class="ttdeci">int numQubitsInStateVec</div><div class="ttdoc">Number of qubits in the state-vector - this is double the number represented for mixed states...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00109">QuEST.h:109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a52ad9f9ad9b2fd6a76f6d433b3b217"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a52ad9f9ad9b2fd6a76f6d433b3b217">&#9670;&nbsp;</a></span>statevec_destroyQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_destroyQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01349">1349</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00114">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00109">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00141">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00123">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                                     {</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    qureg.<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a> = 0;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    qureg.<a class="code" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a> = 0;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> = 0;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    free(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real);</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    free(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag);</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        free(qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real);</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        free(qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    }</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real = NULL;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag = NULL;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real = NULL;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag = NULL;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;}</div><div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00141">QuEST.h:141</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="structQureg_html_adef4935cac95763c29164cf99b144ed4"><div class="ttname"><a href="structQureg.html#adef4935cac95763c29164cf99b144ed4">Qureg::numAmpsTotal</a></div><div class="ttdeci">long long int numAmpsTotal</div><div class="ttdoc">Total number of amplitudes, which are possibly distributed among machines. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00114">QuEST.h:114</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00123">QuEST.h:123</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_a0a86e8a50ea8c998b4a0a6640c5a1218"><div class="ttname"><a href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">Qureg::numQubitsInStateVec</a></div><div class="ttdeci">int numQubitsInStateVec</div><div class="ttdoc">Number of qubits in the state-vector - this is double the number represented for mixed states...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00109">QuEST.h:109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a430d98e35f1eae7f0815ac539057cf67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a430d98e35f1eae7f0815ac539057cf67">&#9670;&nbsp;</a></span>statevec_findProbabilityOfZeroDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> statevec_findProbabilityOfZeroDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk. </p>
<p>Size of regions to skip is a multiple of chunkSize. The results are communicated and aggregated by the caller</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03257">3257</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01245">statevec_calcProbOfOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;                                                              {</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;    <span class="comment">// ----- measured probability</span></div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>   totalProbability;                                  <span class="comment">// probability (returned) value</span></div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    <span class="comment">//            find probability                                      //</span></div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    <span class="comment">// initialise returned value</span></div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    totalProbability = 0.0;</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;<span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;<span class="preprocessor">    private   (thisTask) \</span></div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;<span class="preprocessor">    reduction ( +:totalProbability )</span></div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    {</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;            totalProbability += stateVecReal[thisTask]*stateVecReal[thisTask]</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;                + stateVecImag[thisTask]*stateVecImag[thisTask];</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;        }</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;    }</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    <span class="keywordflow">return</span> totalProbability;</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa06d0143cea46f1e425c61ac6f6f9a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa06d0143cea46f1e425c61ac6f6f9a2">&#9670;&nbsp;</a></span>statevec_findProbabilityOfZeroLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> statevec_findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk. </p>
<p>Size of regions to skip is less than the size of one chunk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03201">3201</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01245">statevec_calcProbOfOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;{</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    <span class="comment">// ----- sizes</span></div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                  <span class="comment">// size of blocks</span></div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span></div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    <span class="comment">// ----- indices</span></div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                  <span class="comment">// current block</span></div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;         index;                                               <span class="comment">// current index for first half block</span></div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    <span class="comment">// ----- measured probability</span></div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>   totalProbability;                                  <span class="comment">// probability (returned) value</span></div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   </div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <span class="comment">//            dimensions                                            //</span></div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span></div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    <span class="comment">// and then the number to skip</span></div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock;                         <span class="comment">// size of blocks (pairs of measure and skip entries)</span></div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    <span class="comment">// initialise returned value</span></div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    totalProbability = 0.0;</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;<span class="preprocessor">    shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;<span class="preprocessor">    private   (thisTask,thisBlock,index) \</span></div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;<span class="preprocessor">    reduction ( +:totalProbability )</span></div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;    {</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;            thisBlock = thisTask / sizeHalfBlock;</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;            index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;            totalProbability += stateVecReal[index]*stateVecReal[index]</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                + stateVecImag[index]*stateVecImag[index];</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        }</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;    }</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    <span class="keywordflow">return</span> totalProbability;</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6870e335f2a78b724f603cd9f820b9ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6870e335f2a78b724f603cd9f820b9ab">&#9670;&nbsp;</a></span>statevec_getEnvironmentString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_getEnvironmentString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>str</em>[200]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01391">1391</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00109">Qureg::numQubitsInStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00141">QuESTEnv::numRanks</a>.</p>
<div class="fragment"><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                                                                            {</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordtype">int</span> numThreads=1;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    numThreads=omp_get_max_threads(); </div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    sprintf(str, <span class="stringliteral">&quot;%dqubits_CPU_%dranksx%dthreads&quot;</span>, qureg.<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a>, env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, numThreads);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;}</div><div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00141">QuEST.h:141</a></div></div>
<div class="ttc" id="structQureg_html_a0a86e8a50ea8c998b4a0a6640c5a1218"><div class="ttname"><a href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">Qureg::numQubitsInStateVec</a></div><div class="ttdeci">int numQubitsInStateVec</div><div class="ttdoc">Number of qubits in the state-vector - this is double the number represented for mixed states...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00109">QuEST.h:109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abea6570b95fdfa102511ccd1fcb30685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea6570b95fdfa102511ccd1fcb30685">&#9670;&nbsp;</a></span>statevec_hadamardDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_hadamardDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>updateUpper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updateUpper</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02929">2929</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01190">statevec_hadamard()</a>.</p>
<div class="fragment"><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;{</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    <span class="keywordtype">int</span> sign;</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    <span class="keywordflow">if</span> (updateUpper) sign=1;</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <span class="keywordflow">else</span> sign=-1;</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> recRoot2 = 1.0/sqrt(2);</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;<span class="preprocessor">            recRoot2, sign) \</span></div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    {</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;            <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;            stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;            stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;            stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            stateVecRealOut[thisTask] = recRoot2*(stateRealUp + sign*stateRealLo);</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;            stateVecImagOut[thisTask] = recRoot2*(stateImagUp + sign*stateImagLo);</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;        }</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    }</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;}</div><div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a24f9ade18290c82bbb2c4a706b3d5999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24f9ade18290c82bbb2c4a706b3d5999">&#9670;&nbsp;</a></span>statevec_hadamardLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_hadamardLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02869">2869</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01190">statevec_hadamard()</a>.</p>
<div class="fragment"><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;{</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> recRoot2 = 1.0/sqrt(2);</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, recRoot2) \</span></div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    {</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;            stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;            stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;            stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;            stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;            stateVecReal[indexUp] = recRoot2*(stateRealUp + stateRealLo);</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;            stateVecImag[indexUp] = recRoot2*(stateImagUp + stateImagLo);</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;            stateVecReal[indexLo] = recRoot2*(stateRealUp - stateRealLo);</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;            stateVecImag[indexLo] = recRoot2*(stateImagUp - stateImagLo);</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        } </div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    }</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a758bad4237ff0bf3b4ff5be626a982ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a758bad4237ff0bf3b4ff5be626a982ae">&#9670;&nbsp;</a></span>statevec_initBlankState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initBlankState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01399">1399</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l01429">statevec_initZeroState()</a>.</p>
<div class="fragment"><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;{</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="comment">// initialise the state-vector to all-zeroes</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    {</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            stateVecReal[index] = 0.0;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            stateVecImag[index] = 0.0;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        }</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    }</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a288dc4b46bdacd69cbf4a6fd070d26a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a288dc4b46bdacd69cbf4a6fd070d26a7">&#9670;&nbsp;</a></span>statevec_initClassicalState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>stateInd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01471">1471</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;{</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="comment">// initialise the state to vector to all zeros</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    {</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            stateVecReal[index] = 0.0;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            stateVecImag[index] = 0.0;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        }</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    }</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">// give the specified classical state prob 1</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> == stateInd/stateVecSize){</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        stateVecReal[stateInd % stateVecSize] = 1.0;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        stateVecImag[stateInd % stateVecSize] = 0.0;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    }</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a482fc361fd5f08075404c72e536316a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a482fc361fd5f08075404c72e536316a0">&#9670;&nbsp;</a></span>statevec_initPlusState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initPlusState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01439">1439</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00118">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;{</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    chunkSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    stateVecSize = chunkSize*qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> normFactor = 1.0/sqrt((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>)stateVecSize);</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="comment">// initialise the state to |+++..+++&gt; = 1/normFactor {1, 1, 1, ...}</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    {</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            stateVecReal[index] = normFactor;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            stateVecImag[index] = 0.0;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        }</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    }</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00118">QuEST.h:118</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a38445cdb2a18671a7c73112ce3337acb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38445cdb2a18671a7c73112ce3337acb">&#9670;&nbsp;</a></span>statevec_initStateDebug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initStateDebug </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. </p>
<p>For debugging processes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01592">1592</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;{</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexOffset;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    chunkSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    indexOffset = chunkSize * qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, indexOffset) \</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    {</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            stateVecReal[index] = ((indexOffset + index)*2.0)/10.0;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            stateVecImag[index] = ((indexOffset + index)*2.0+1.0)/10.0;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        }</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    }</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05756b45f10135bb2eeb07380f806c20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05756b45f10135bb2eeb07380f806c20">&#9670;&nbsp;</a></span>statevec_initStateFromSingleFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_initStateFromSingleFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>filename</em>[200], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01626">1626</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00118">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00155">syncQuESTEnv()</a>.</p>
<div class="fragment"><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                                                                                    {</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexInChunk, totalIndex;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    chunkSize = qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    stateVecSize = chunkSize*qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    FILE *fp;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordtype">char</span> line[200];</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rank=0; rank&lt;(qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>); rank++){</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        <span class="keywordflow">if</span> (rank==qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>){</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            </div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            <span class="comment">// indicate file open failure</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            <span class="keywordflow">if</span> (fp == NULL)</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            </div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            indexInChunk = 0; totalIndex = 0;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            <span class="keywordflow">while</span> (fgets(line, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*200, fp) != NULL &amp;&amp; totalIndex&lt;stateVecSize){</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                <span class="keywordflow">if</span> (line[0]!=<span class="charliteral">&#39;#&#39;</span>){</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                    <span class="keywordtype">int</span> chunkId = (int) (totalIndex/chunkSize);</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                    <span class="keywordflow">if</span> (chunkId==qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>){</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="preprocessor">                        # if QuEST_PREC==1</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                        sscanf(line, <span class="stringliteral">&quot;%f, %f&quot;</span>, &amp;(stateVecReal[indexInChunk]), </div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                                &amp;(stateVecImag[indexInChunk])); </div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="preprocessor">                        # elif QuEST_PREC==2                    </span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                        sscanf(line, <span class="stringliteral">&quot;%lf, %lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), </div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                                &amp;(stateVecImag[indexInChunk]));</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="preprocessor">                        # elif QuEST_PREC==4</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                        sscanf(line, <span class="stringliteral">&quot;%Lf, %Lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), </div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                                &amp;(stateVecImag[indexInChunk]));</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="preprocessor">                        # endif</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                        indexInChunk += 1;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                    }</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                    totalIndex += 1;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                }</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            }   </div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            fclose(fp);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        }</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a>(env);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    }</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    </div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="comment">// indicate success</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a></div><div class="ttdeci">void syncQuESTEnv(QuESTEnv env)</div><div class="ttdoc">Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00155">QuEST_cpu_distributed.c:155</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00118">QuEST.h:118</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a923906770cac0da9e3459bae58de9e64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a923906770cac0da9e3459bae58de9e64">&#9670;&nbsp;</a></span>statevec_initStateOfSingleQubit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initStateOfSingleQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubitId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits to be initialised </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qubitId</td><td>id of qubit to set to state 'outcome' </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">value</td><td>of qubit 'qubitId' </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01546">1546</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00118">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;{</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    chunkSize = qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    stateVecSize = chunkSize*qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> normFactor = 1.0/sqrt((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>)stateVecSize/2.0);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor, qubitId, outcome) \</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="preprocessor">    private  (index, bit) </span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    {</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            bit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(qubitId, index+chunkId*chunkSize);</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            <span class="keywordflow">if</span> (bit==outcome) {</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                stateVecReal[index] = normFactor;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                stateVecImag[index] = 0.0;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                stateVecReal[index] = 0.0;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                stateVecImag[index] = 0.0;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;            }</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        }</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    }</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00118">QuEST.h:118</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ca0c6ba07ab2b4b437321bf17efc966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ca0c6ba07ab2b4b437321bf17efc966">&#9670;&nbsp;</a></span>statevec_initZeroState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initZeroState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01429">1429</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01399">statevec_initBlankState()</a>.</p>
<div class="fragment"><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;{</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <a class="code" href="QuEST__cpu_8c.html#a758bad4237ff0bf3b4ff5be626a982ae">statevec_initBlankState</a>(qureg);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>==0){</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <span class="comment">// zero state |0000..0000&gt; has probability 1</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[0] = 1.0;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[0] = 0.0;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    }</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a758bad4237ff0bf3b4ff5be626a982ae"><div class="ttname"><a href="QuEST__cpu_8c.html#a758bad4237ff0bf3b4ff5be626a982ae">statevec_initBlankState</a></div><div class="ttdeci">void statevec_initBlankState(Qureg qureg)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01399">QuEST_cpu.c:1399</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc5726bc7f899d5fd85454ffcc64f60c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc5726bc7f899d5fd85454ffcc64f60c">&#9670;&nbsp;</a></span>statevec_multiControlledMultiQubitUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledMultiQubitUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>targs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>numTargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01847">1847</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">flipBit()</a>, <a class="el" href="QuEST_8h_source.html#l00089">ComplexMatrixN::imag</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00038">insertZeroBit()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00087">ComplexMatrixN::numQubits</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01843">qsortComp()</a>, <a class="el" href="QuEST_8h_source.html#l00088">ComplexMatrixN::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01405">statevec_multiControlledMultiQubitUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;{</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">// can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reVec = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imVec = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    </div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> &gt;&gt; numTargs;  <span class="comment">// kernel called on every 1 in 2^numTargs amplitudes</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTargAmps = 1 &lt;&lt; u.<a class="code" href="structComplexMatrixN.html#a606f7afbc3f65a596bdca21cb43be6a8">numQubits</a>;  <span class="comment">// num amps to be modified by each task</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    </div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="comment">// the global (between all nodes) index of this node&#39;s start index</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndStart = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>; </div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    </div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInd00; <span class="comment">// this thread&#39;s index of |..0..0..&gt; (target qubits = 0) </span></div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisGlobalInd00; <span class="comment">// the global (between all nodes) index of this thread&#39;s |..0..0..&gt; state</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ind;   <span class="comment">// each thread&#39;s iteration of amplitudes to modify</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="keywordtype">int</span> i, t, r, c, g;  <span class="comment">// each thread&#39;s iteration of amps and targets </span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> reElem, imElem;  <span class="comment">// each thread&#39;s iteration of u elements</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    </div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="comment">// each thread/task will record and modify numTargAmps amplitudes, but do so in global arrays</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="comment">// (of course, tasks eliminated by the ctrlMask won&#39;t edit their allocation)</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="comment">// strtucture: [thread0..., thread1..., ]</span></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ampInds[qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>];  <span class="comment">// = numTasks*numTargAmps</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> reAmps[qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>];</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> imAmps[qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>];</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    </div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="comment">// we need a sorted targets list to find thisInd00 for each task.</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <span class="comment">// we can&#39;t modify targets, because the user-ordering of targets matters in u</span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordtype">int</span> sortedTargs[numTargs]; </div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=0; t &lt; numTargs; t++) </div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        sortedTargs[t] = targs[t];</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    qsort(sortedTargs, numTargs, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <a class="code" href="QuEST__cpu_8c.html#afa4231f79fe9498e4fd87cc70cde5a9d">qsortComp</a>);</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    </div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="preprocessor">    shared   (reVec,imVec, numTasks,numTargAmps,globalIndStart, ctrlMask,targs,sortedTargs,u, ampInds,reAmps,imAmps) \</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="preprocessor">    private  (thisTask,thisInd00,thisGlobalInd00,ind,i,t,r,c,g,reElem,imElem) </span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    {</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            </div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            <span class="comment">// find this task&#39;s start index (where all targs are 0)</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;            thisInd00 = thisTask;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;            <span class="keywordflow">for</span> (t=0; t &lt; numTargs; t++)</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                thisInd00 = <a class="code" href="QuEST__cpu__internal_8h.html#a3e7cd3c24326cafa6dfb02dce9477198">insertZeroBit</a>(thisInd00, sortedTargs[t]);</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                </div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            <span class="comment">// this task only modifies amplitudes if control qubits are 1 for this state</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            thisGlobalInd00 = thisInd00 + globalIndStart;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;            <span class="keywordflow">if</span> (ctrlMask &amp;&amp; ((ctrlMask &amp; thisGlobalInd00) != ctrlMask))</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                </div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            <span class="comment">// determine the indices and record values of this tasks&#39;s target amps</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;            <span class="keywordflow">for</span> (i=0; i &lt; numTargAmps; i++) {</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                </div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                <span class="comment">// get statevec index of current target qubit assignment</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                ind = thisInd00;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                <span class="keywordflow">for</span> (t=0; t &lt; numTargs; t++)</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a>(t, i))</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                        ind = <a class="code" href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a>(ind, targs[t]);</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                </div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                <span class="comment">// update this tasks&#39;s allocation of the global arrays</span></div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                g = thisTask*numTargAmps + i; </div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                ampInds[g] = ind;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                reAmps [g] = reVec[ind];</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                imAmps [g] = imVec[ind];</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;            }</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;            </div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;            <span class="comment">// modify this tasks&#39;s target amplitudes</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;            <span class="keywordflow">for</span> (r=0; r &lt; numTargAmps; r++) {</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                ind = ampInds[thisTask*numTargAmps + r];</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                reVec[ind] = 0;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                imVec[ind] = 0;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;                <span class="keywordflow">for</span> (c=0; c &lt; numTargAmps; c++) {</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                    g = thisTask*numTargAmps + c;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                    reElem = u.<a class="code" href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">real</a>[r][c];</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                    imElem = u.<a class="code" href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">imag</a>[r][c];</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                    reVec[ind] += reAmps[g]*reElem - imAmps[g]*imElem;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                    imVec[ind] += reAmps[g]*imElem + imAmps[g]*reElem;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                }</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;            }</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        }</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    }</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="structComplexMatrixN_html_a606f7afbc3f65a596bdca21cb43be6a8"><div class="ttname"><a href="structComplexMatrixN.html#a606f7afbc3f65a596bdca21cb43be6a8">ComplexMatrixN::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00087">QuEST.h:87</a></div></div>
<div class="ttc" id="structComplexMatrixN_html_afde13e469a3b4f179f45e53d1ec0a7cf"><div class="ttname"><a href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">ComplexMatrixN::imag</a></div><div class="ttdeci">qreal ** imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00089">QuEST.h:89</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_ab5666cbb8f1de8fe9864c0f3fcc8a3ec"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a></div><div class="ttdeci">long long int flipBit(long long int number, int bitInd)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00026">QuEST_cpu_internal.h:26</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a3e7cd3c24326cafa6dfb02dce9477198"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a3e7cd3c24326cafa6dfb02dce9477198">insertZeroBit</a></div><div class="ttdeci">long long int insertZeroBit(long long int number, int index)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00038">QuEST_cpu_internal.h:38</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_afa4231f79fe9498e4fd87cc70cde5a9d"><div class="ttname"><a href="QuEST__cpu_8c.html#afa4231f79fe9498e4fd87cc70cde5a9d">qsortComp</a></div><div class="ttdeci">int qsortComp(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01843">QuEST_cpu.c:1843</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="structComplexMatrixN_html_a446e8a077597e4f76049d547df0c9738"><div class="ttname"><a href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">ComplexMatrixN::real</a></div><div class="ttdeci">qreal ** real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00088">QuEST.h:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4ee5979d475e8c729294b8ef7e0270d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4ee5979d475e8c729294b8ef7e0270d">&#9670;&nbsp;</a></span>statevec_multiControlledPhaseFlip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledPhaseFlip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numControlQubits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03326">3326</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__common_8c_source.html#l00039">getQubitBitMask()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;{</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask = <a class="code" href="QuEST__common_8c.html#abd1285091450c7c2806cc26c71eb5df2">getQubitBitMask</a>(controlQubits, numControlQubits);</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag, mask ) \</span></div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="preprocessor">    private  (index)</span></div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    {</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;            <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;                stateVecReal [index] = - stateVecReal [index];</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                stateVecImag [index] = - stateVecImag [index];</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;            }</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        }</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    }</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="QuEST__common_8c_html_abd1285091450c7c2806cc26c71eb5df2"><div class="ttname"><a href="QuEST__common_8c.html#abd1285091450c7c2806cc26c71eb5df2">getQubitBitMask</a></div><div class="ttdeci">long long int getQubitBitMask(int *qubits, const int numQubits)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00039">QuEST_common.c:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa662796ea6e0f471143c53becae8c12c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa662796ea6e0f471143c53becae8c12c">&#9670;&nbsp;</a></span>statevec_multiControlledPhaseShift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledPhaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03054">3054</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__common_8c_source.html#l00039">getQubitBitMask()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;{</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask = <a class="code" href="QuEST__common_8c.html#abd1285091450c7c2806cc26c71eb5df2">getQubitBitMask</a>(controlQubits, numControlQubits);</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    </div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealLo, stateImagLo;</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = cos(angle);</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = sin(angle);</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag, mask) \</span></div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<span class="preprocessor">    private  (index, stateRealLo, stateImagLo)</span></div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    {</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;            <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;                </div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                stateRealLo = stateVecReal[index];</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                stateImagLo = stateVecImag[index];</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;            </div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  </div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;            }</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;        }</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;    }</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="QuEST__common_8c_html_abd1285091450c7c2806cc26c71eb5df2"><div class="ttname"><a href="QuEST__common_8c.html#abd1285091450c7c2806cc26c71eb5df2">getQubitBitMask</a></div><div class="ttdeci">long long int getQubitBitMask(int *qubits, const int numQubits)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00039">QuEST_common.c:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7f5f0bf7fa945d46eb51e79e00a8dfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7f5f0bf7fa945d46eb51e79e00a8dfd">&#9670;&nbsp;</a></span>statevec_multiControlledTwoQubitUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledTwoQubitUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix4.html">ComplexMatrix4</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01748">1748</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">flipBit()</a>, <a class="el" href="QuEST_8h_source.html#l00080">ComplexMatrix4::imag</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00079">ComplexMatrix4::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01367">statevec_multiControlledTwoQubitUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                                                                                                                                     {</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="comment">// can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reVec = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imVec = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    </div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="comment">// the global (between all nodes) index of this node&#39;s start index</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndStart = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>; </div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    </div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> &gt;&gt; 2; <span class="comment">// each iteration updates 4 amplitudes</span></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisGlobalInd00;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ind00, ind01, ind10, ind11;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> re00, re01, re10, re11;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> im00, im01, im10, im11;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    </div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="preprocessor">    shared   (reVec,imVec,globalIndStart,numTasks,ctrlMask,u) \</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="preprocessor">    private  (thisTask, thisGlobalInd00, ind00,ind01,ind10,ind11, re00,re01,re10,re11, im00,im01,im10,im11) </span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    {</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            </div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;            <span class="comment">// determine ind00 of |..0..0..&gt;</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;            ind00 = <a class="code" href="QuEST__cpu__internal_8h.html#a0fcb576150cd08659e7adb445f1b3d82">insertTwoZeroBits</a>(thisTask, q1, q2);</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            </div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            <span class="comment">// skip amplitude if controls aren&#39;t in 1 state (overloaded for speed)</span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            thisGlobalInd00 = ind00 + globalIndStart;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            <span class="keywordflow">if</span> (ctrlMask &amp;&amp; ((ctrlMask &amp; thisGlobalInd00) != ctrlMask))</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            </div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            <span class="comment">// inds of |..0..1..&gt;, |..1..0..&gt; and |..1..1..&gt;</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            ind01 = <a class="code" href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a>(ind00, q1);</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            ind10 = <a class="code" href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a>(ind00, q2);</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            ind11 = <a class="code" href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a>(ind01, q2);</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            <span class="comment">// extract statevec amplitudes </span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            re00 = reVec[ind00]; im00 = imVec[ind00];</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            re01 = reVec[ind01]; im01 = imVec[ind01];</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            re10 = reVec[ind10]; im10 = imVec[ind10];</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            re11 = reVec[ind11]; im11 = imVec[ind11];</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            <span class="comment">// apply u * {amp00, amp01, amp10, amp11}</span></div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            reVec[ind00] = </div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][0]*re00 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][0]*im00 +</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][1]*re01 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][1]*im01 +</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][2]*re10 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][2]*im10 +</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][3]*re11 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][3]*im11;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            imVec[ind00] =</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][0]*re00 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][0]*im00 +</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][1]*re01 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][1]*im01 +</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][2]*re10 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][2]*im10 +</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][3]*re11 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][3]*im11;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                </div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            reVec[ind01] = </div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][0]*re00 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][0]*im00 +</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][1]*re01 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][1]*im01 +</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][2]*re10 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][2]*im10 +</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][3]*re11 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][3]*im11;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            imVec[ind01] =</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][0]*re00 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][0]*im00 +</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][1]*re01 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][1]*im01 +</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][2]*re10 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][2]*im10 +</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][3]*re11 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][3]*im11;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                </div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            reVec[ind10] = </div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][0]*re00 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][0]*im00 +</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][1]*re01 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][1]*im01 +</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][2]*re10 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][2]*im10 +</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][3]*re11 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][3]*im11;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            imVec[ind10] =</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][0]*re00 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][0]*im00 +</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][1]*re01 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][1]*im01 +</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][2]*re10 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][2]*im10 +</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][3]*re11 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][3]*im11;    </div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                </div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            reVec[ind11] = </div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][0]*re00 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][0]*im00 +</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][1]*re01 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][1]*im01 +</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][2]*re10 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][2]*im10 +</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][3]*re11 - u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][3]*im11;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            imVec[ind11] =</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][0]*re00 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][0]*im00 +</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][1]*re01 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][1]*im01 +</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][2]*re10 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][2]*im10 +</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                u.<a class="code" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][3]*re11 + u.<a class="code" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][3]*im11;    </div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        }</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    }</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;}</div><div class="ttc" id="structComplexMatrix4_html_a1f6bb840b5a9e6252980cab7a14f1a35"><div class="ttname"><a href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">ComplexMatrix4::imag</a></div><div class="ttdeci">qreal imag[4][4]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00080">QuEST.h:80</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a0fcb576150cd08659e7adb445f1b3d82"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a0fcb576150cd08659e7adb445f1b3d82">insertTwoZeroBits</a></div><div class="ttdeci">long long int insertTwoZeroBits(long long int number, int bit1, int bit2)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00045">QuEST_cpu_internal.h:45</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_ab5666cbb8f1de8fe9864c0f3fcc8a3ec"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a></div><div class="ttdeci">long long int flipBit(long long int number, int bitInd)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00026">QuEST_cpu_internal.h:26</a></div></div>
<div class="ttc" id="structComplexMatrix4_html_aeadc9893e1b16cdd585dac523e73926c"><div class="ttname"><a href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">ComplexMatrix4::real</a></div><div class="ttdeci">qreal real[4][4]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00079">QuEST.h:79</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a623e5479f5dd45e87fe2acef55620771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a623e5479f5dd45e87fe2acef55620771">&#9670;&nbsp;</a></span>statevec_multiControlledUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlQubitsMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlFlipMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where all the control qubits are 1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctrlQubitsMask</td><td>a bit mask indicating whether each qubit is a control (1) or not (0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctrlFlipMask</td><td>a bit mask indicating whether each qubit (only controls are relevant) should be flipped when checking the control condition </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02448">2448</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00064">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00063">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00981">statevec_multiControlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;{</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot1Real=rot1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot2Real=rot2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag, ctrlQubitsMask,ctrlFlipMask) \</span></div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    {</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;            <span class="keywordflow">if</span> (ctrlQubitsMask == (ctrlQubitsMask &amp; ((thisTask+chunkId*chunkSize) ^ ctrlFlipMask))) {</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp </div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                    + rot2Real*stateRealLo - rot2Imag*stateImagLo;</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp </div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                    + rot2Real*stateImagLo + rot2Imag*stateRealLo;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;            }</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        }</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    }</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;}</div><div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00063">QuEST.h:63</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00064">QuEST.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae757d3b816aa7ba7bea13334a9b77441"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae757d3b816aa7ba7bea13334a9b77441">&#9670;&nbsp;</a></span>statevec_multiControlledUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlQubitsMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlFlipMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02175">2175</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00072">ComplexMatrix2::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00071">ComplexMatrix2::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00981">statevec_multiControlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;{</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u, ctrlQubitsMask,ctrlFlipMask) \</span></div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock, indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    {</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            </div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            </div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;            <span class="comment">// take the basis index, flip the designated (XOR) &#39;control&#39; bits, AND with the controls.</span></div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            <span class="comment">// if this equals the control mask, the control qubits have the desired values in the basis index</span></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            <span class="keywordflow">if</span> (ctrlQubitsMask == (ctrlQubitsMask &amp; ((indexUp+chunkId*chunkSize) ^ ctrlFlipMask))) {</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateImagUp </div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateImagLo;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateRealUp </div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateRealLo;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateImagUp </div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateImagLo;</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateRealUp </div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateRealLo;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;            }</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        } </div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    }</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a3ea98d545b67a190ee6abe936c72076f"><div class="ttname"><a href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">ComplexMatrix2::real</a></div><div class="ttdeci">qreal real[2][2]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00071">QuEST.h:71</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structComplexMatrix2_html_a3a2b60a9e00ccef054a6de3b9307c1be"><div class="ttname"><a href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">ComplexMatrix2::imag</a></div><div class="ttdeci">qreal imag[2][2]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00072">QuEST.h:72</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d88b4ed94ab024e5e7b2f1f4f505b44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d88b4ed94ab024e5e7b2f1f4f505b44">&#9670;&nbsp;</a></span>statevec_multiRotateZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiRotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03104">3104</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l03095">getBitMaskParity()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;{</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    </div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateReal, stateImag;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = cos(angle/2.0);</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = sin(angle/2.0); </div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    </div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    <span class="comment">// = +-1, to flip sinAngle based on target qubit parity, to effect</span></div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    <span class="comment">// exp(-angle/2 i fac_j)|j&gt;</span></div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <span class="keywordtype">int</span> fac; </div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag, mask) \</span></div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;<span class="preprocessor">    private  (index, fac, stateReal, stateImag)</span></div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    {</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;            stateReal = stateVecReal[index];</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;            stateImag = stateVecImag[index];</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;            </div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;            <span class="comment">// odd-parity target qubits get fac_j = -1</span></div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;            fac = <a class="code" href="QuEST__cpu_8c.html#a37e522505286f17fe6ef74b9f607a5c6">getBitMaskParity</a>(mask &amp; (index+chunkId*chunkSize))? -1 : 1;</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;            stateVecReal[index] = cosAngle*stateReal + fac * sinAngle*stateImag;</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;            stateVecImag[index] = - fac * sinAngle*stateReal + cosAngle*stateImag;  </div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        }</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    }</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a37e522505286f17fe6ef74b9f607a5c6"><div class="ttname"><a href="QuEST__cpu_8c.html#a37e522505286f17fe6ef74b9f607a5c6">getBitMaskParity</a></div><div class="ttdeci">int getBitMaskParity(long long int mask)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l03095">QuEST_cpu.c:3095</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a464efbd1d7ca5a7b25c83ada001955c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a464efbd1d7ca5a7b25c83ada001955c2">&#9670;&nbsp;</a></span>statevec_pauliXDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliXDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02557">2557</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01018">statevec_pauliX()</a>.</p>
<div class="fragment"><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;{</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="preprocessor">    private  (thisTask)</span></div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    {</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;            stateVecRealOut[thisTask] = stateVecRealIn[thisTask];</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            stateVecImagOut[thisTask] = stateVecImagIn[thisTask];</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        }</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    }</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;} </div><div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a842aaecd6d6cdc194c0b7c84623d2111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a842aaecd6d6cdc194c0b7c84623d2111">&#9670;&nbsp;</a></span>statevec_pauliXLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliXLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02499">2499</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01018">statevec_pauliX()</a>.</p>
<div class="fragment"><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;{</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateImagUp;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    {</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;            stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;            stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;            stateVecReal[indexUp] = stateVecReal[indexLo];</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;            stateVecImag[indexUp] = stateVecImag[indexLo];</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;            stateVecReal[indexLo] = stateRealUp;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            stateVecImag[indexLo] = stateImagUp;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        } </div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    }</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3528cf8d741807987d8150d59ccb1ba3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3528cf8d741807987d8150d59ccb1ba3">&#9670;&nbsp;</a></span>statevec_pauliYDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>updateUpper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>conjFac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by +-{{0,-i},{i,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updateUpper</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02739">2739</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01074">statevec_pauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01099">statevec_pauliYConj()</a>.</p>
<div class="fragment"><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;{</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    <span class="keywordtype">int</span> realSign=1, imagSign=1;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <span class="keywordflow">if</span> (updateUpper) imagSign=-1;</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="keywordflow">else</span> realSign = -1;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;<span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut,realSign,imagSign) \</span></div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="preprocessor">    private  (thisTask)</span></div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    {</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;            stateVecRealOut[thisTask] = conjFac * realSign * stateVecImagIn[thisTask];</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;            stateVecImagOut[thisTask] = conjFac * imagSign * stateVecRealIn[thisTask];</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        }</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    }</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;} </div><div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8edf5f2066b05fb343931f45e2bec8f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8edf5f2066b05fb343931f45e2bec8f8">&#9670;&nbsp;</a></span>statevec_pauliYLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>conjFac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02682">2682</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01074">statevec_pauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01099">statevec_pauliYConj()</a>.</p>
<div class="fragment"><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;{</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateImagUp;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    {</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;            stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;            stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;            stateVecReal[indexUp] = conjFac * stateVecImag[indexLo];</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;            stateVecImag[indexUp] = conjFac * -stateVecReal[indexLo];</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            stateVecReal[indexLo] = conjFac * -stateImagUp;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;            stateVecImag[indexLo] = conjFac * stateRealUp;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        } </div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    }</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8972669148af60d7e1c09687f69673d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8972669148af60d7e1c09687f69673d4">&#9670;&nbsp;</a></span>statevec_phaseShiftByTerm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_phaseShiftByTerm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>term</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02975">2975</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00022">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00064">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00063">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;{       </div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;    <span class="keywordtype">int</span> targetBit;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    </div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    </div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealLo, stateImagLo;</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;<span class="preprocessor"># pragma omp parallel for \</span></div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span></div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;<span class="preprocessor">    private  (index,targetBit,stateRealLo,stateImagLo)             \</span></div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;<span class="preprocessor">    schedule (static)</span></div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;        </div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        <span class="comment">// update the coeff of the |1&gt; state of the target qubit</span></div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        targetBit = <a class="code" href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a> (targetQubit, index+chunkId*chunkSize);</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        <span class="keywordflow">if</span> (targetBit) {</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;            </div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;            stateRealLo = stateVecReal[index];</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;            stateImagLo = stateVecImag[index];</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;            </div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;            stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;            stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  </div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        }</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    }</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a420b30092dc60ff17188e23361d547a5"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a420b30092dc60ff17188e23361d547a5">extractBit</a></div><div class="ttdeci">int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00022">QuEST_cpu_internal.h:22</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00063">QuEST.h:63</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00064">QuEST.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e57230c7995447039e62a84c0a36524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e57230c7995447039e62a84c0a36524">&#9670;&nbsp;</a></span>statevec_reportStateToScreen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_reportStateToScreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reportRank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01367">1367</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00118">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00109">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00155">syncQuESTEnv()</a>.</p>
<div class="fragment"><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                                                                            {</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="keywordtype">int</span> rank;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a>&lt;=5){</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="keywordflow">for</span> (rank=0; rank&lt;qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>; rank++){</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>==rank){</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                <span class="keywordflow">if</span> (reportRank) {</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                    printf(<span class="stringliteral">&quot;Reporting state from rank %d [\n&quot;</span>, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                    printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rank==0) {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                    printf(<span class="stringliteral">&quot;Reporting state [\n&quot;</span>);</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                    printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                }</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                <span class="keywordflow">for</span>(index=0; index&lt;qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>; index++){</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                    <span class="comment">//printf(REAL_STRING_FORMAT &quot;, &quot; REAL_STRING_FORMAT &quot;\n&quot;, qureg.pairStateVec.real[index], qureg.pairStateVec.imag[index]);</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                    printf(REAL_STRING_FORMAT <span class="stringliteral">&quot;, &quot;</span> REAL_STRING_FORMAT <span class="stringliteral">&quot;\n&quot;</span>, qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[index], qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[index]);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                }</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                <span class="keywordflow">if</span> (reportRank || rank==qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>-1) printf(<span class="stringliteral">&quot;]\n&quot;</span>);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            }</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a>(env);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        }</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: reportStateToScreen will not print output for systems of more than 5 qubits.\n&quot;</span>);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a></div><div class="ttdeci">void syncQuESTEnv(QuESTEnv env)</div><div class="ttdoc">Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00155">QuEST_cpu_distributed.c:155</a></div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00118">QuEST.h:118</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="structQureg_html_a0a86e8a50ea8c998b4a0a6640c5a1218"><div class="ttname"><a href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">Qureg::numQubitsInStateVec</a></div><div class="ttdeci">int numQubitsInStateVec</div><div class="ttdoc">Number of qubits in the state-vector - this is double the number represented for mixed states...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00109">QuEST.h:109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa121d55f2ca09c06a96ddcd433c60b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa121d55f2ca09c06a96ddcd433c60b0f">&#9670;&nbsp;</a></span>statevec_setAmps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_setAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>reals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>imags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01269">1269</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                                                                                                              {</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    </div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="comment">/* this is actually distributed, since the user&#39;s code runs on every node */</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    </div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="comment">// local start/end indices of the given amplitudes, assuming they fit in this chunk</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="comment">// these may be negative or above qureg.numAmpsPerChunk</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localStartInd = startInd - qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localEndInd = localStartInd + numAmps; <span class="comment">// exclusive</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    </div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">// add this to a local index to get corresponding elem in reals &amp; imags</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> - startInd;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    </div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="comment">// restrict these indices to fit into this chunk</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">if</span> (localStartInd &lt; 0)</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        localStartInd = 0;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">if</span> (localEndInd &gt; qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>)</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        localEndInd = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="comment">// they may now be out of order = no iterations</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    </div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="comment">// unpacking OpenMP vars</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecRe = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecIm = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    </div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="preprocessor">    shared   (localStartInd,localEndInd, vecRe,vecIm, reals,imags, offset) \</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    {</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="comment">// iterate these local inds - this might involve no iterations</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordflow">for</span> (index=localStartInd; index &lt; localEndInd; index++) {</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            vecRe[index] = reals[index + offset];</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            vecIm[index] = imags[index + offset];</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        }</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    }</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad64a23933361fafc1b6b1787759c2663"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad64a23933361fafc1b6b1787759c2663">&#9670;&nbsp;</a></span>statevec_setWeightedQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_setWeightedQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>fac1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>fac2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>facOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03614">3614</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00064">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00063">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;                                                                                                                  {</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg1.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecRe1 = qureg1.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecIm1 = qureg1.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecRe2 = qureg2.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecIm2 = qureg2.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecReOut = out.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecImOut = out.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> facRe1 = fac1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>; </div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> facIm1 = fac1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> facRe2 = fac2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> facIm2 = fac2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> facReOut = facOut.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> facImOut = facOut.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> re1,im1, re2,im2, reOut,imOut;</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;<span class="preprocessor">    shared    (vecRe1,vecIm1, vecRe2,vecIm2, vecReOut,vecImOut, facRe1,facIm1,facRe2,facIm2, numAmps) \</span></div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;<span class="preprocessor">    private   (index, re1,im1, re2,im2, reOut,imOut)</span></div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    {</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;            re1 = vecRe1[index]; im1 = vecIm1[index];</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;            re2 = vecRe2[index]; im2 = vecIm2[index];</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;            reOut = vecReOut[index];</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;            imOut = vecImOut[index];</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;            vecReOut[index] = (facReOut*reOut - facImOut*imOut) + (facRe1*re1 - facIm1*im1) + (facRe2*re2 - facIm2*im2);</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;            vecImOut[index] = (facReOut*imOut + facImOut*reOut) + (facRe1*im1 + facIm1*re1) + (facRe2*im2 + facIm2*re2);</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;        }</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    }</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00063">QuEST.h:63</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00064">QuEST.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe74a5a9db8340e37b80fbc77338894d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe74a5a9db8340e37b80fbc77338894d">&#9670;&nbsp;</a></span>statevec_swapQubitAmpsDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_swapQubitAmpsDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pairRank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qb2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>qureg.pairStateVec contains the entire set of amplitudes of the paired node which includes the set of all amplitudes which need to be swapped between |..0..1..&gt; and |..1..0..&gt; </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03574">3574</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00116">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">flipBit()</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00034">isOddParity()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00123">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01340">statevec_swapQubitAmps()</a>.</p>
<div class="fragment"><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;                                                                                    {</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    </div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;    <span class="comment">// can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reVec = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imVec = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *rePairVec = qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real;</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imPairVec = qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag;</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    </div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numLocalAmps = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalStartInd = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * numLocalAmps;</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> pairGlobalStartInd = pairRank * numLocalAmps;</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localInd, globalInd;</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> pairLocalInd, pairGlobalInd;</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    </div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;<span class="preprocessor">    shared   (reVec,imVec,rePairVec,imPairVec,numLocalAmps,globalStartInd,pairGlobalStartInd,qb1,qb2) \</span></div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;<span class="preprocessor">    private  (localInd,globalInd, pairLocalInd,pairGlobalInd) </span></div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    {</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;        <span class="keywordflow">for</span> (localInd=0; localInd &lt; numLocalAmps; localInd++) { </div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;            </div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            globalInd = globalStartInd + localInd;</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="QuEST__cpu__internal_8h.html#a9fed82462428909e9f7adc5ed2771437">isOddParity</a>(globalInd, qb1, qb2)) {</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;                </div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                pairGlobalInd = <a class="code" href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a>(<a class="code" href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a>(globalInd, qb1), qb2);</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                pairLocalInd = pairGlobalInd - pairGlobalStartInd;</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;                </div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;                reVec[localInd] = rePairVec[pairLocalInd];</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                imVec[localInd] = imPairVec[pairLocalInd];</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;            }</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;        }</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    }</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_ab5666cbb8f1de8fe9864c0f3fcc8a3ec"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a></div><div class="ttdeci">long long int flipBit(long long int number, int bitInd)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00026">QuEST_cpu_internal.h:26</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00123">QuEST.h:123</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00116">QuEST.h:116</a></div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_a9fed82462428909e9f7adc5ed2771437"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a9fed82462428909e9f7adc5ed2771437">isOddParity</a></div><div class="ttdeci">int isOddParity(long long int number, int qb1, int qb2)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00034">QuEST_cpu_internal.h:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5b51a28caa8792a3f0c637409a694b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5b51a28caa8792a3f0c637409a694b0">&#9670;&nbsp;</a></span>statevec_swapQubitAmpsLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_swapQubitAmpsLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qb2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It is ensured that all amplitudes needing to be swapped are on this node. </p>
<p>This means that amplitudes for |a 0..0..&gt; to |a 1..1..&gt; all exist on this node and each node has a different bit-string prefix "a". The prefix 'a' (and ergo, the chunkID) don't enter the calculations for the offset of |a 0..1..&gt; and |a 1..0..&gt; from |a 0..0..&gt; and ergo are not featured below. </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03531">3531</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">flipBit()</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01340">statevec_swapQubitAmps()</a>.</p>
<div class="fragment"><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;                                                                {</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;    <span class="comment">// can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reVec = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imVec = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;    </div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> &gt;&gt; 2; <span class="comment">// each iteration updates 2 amps and skips 2 amps</span></div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ind00, ind01, ind10;</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> re01, re10;</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> im01, im10;</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;    </div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;<span class="preprocessor">    shared   (reVec,imVec,numTasks,qb1,qb2) \</span></div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;<span class="preprocessor">    private  (thisTask, ind00,ind01,ind10, re01,re10, im01,im10) </span></div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    {</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {    </div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;            <span class="comment">// determine ind00 of |..0..0..&gt;, |..0..1..&gt; and |..1..0..&gt;</span></div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;            ind00 = <a class="code" href="QuEST__cpu__internal_8h.html#a0fcb576150cd08659e7adb445f1b3d82">insertTwoZeroBits</a>(thisTask, qb1, qb2);</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;            ind01 = <a class="code" href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a>(ind00, qb1);</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;            ind10 = <a class="code" href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a>(ind00, qb2);</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;            <span class="comment">// extract statevec amplitudes </span></div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;            re01 = reVec[ind01]; im01 = imVec[ind01];</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;            re10 = reVec[ind10]; im10 = imVec[ind10];</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;            <span class="comment">// swap 01 and 10 amps</span></div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;            reVec[ind01] = re10; reVec[ind10] = re01;</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;            imVec[ind01] = im10; imVec[ind10] = im01;</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;        }</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    }</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;}</div><div class="ttc" id="QuEST__cpu__internal_8h_html_a0fcb576150cd08659e7adb445f1b3d82"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a0fcb576150cd08659e7adb445f1b3d82">insertTwoZeroBits</a></div><div class="ttdeci">long long int insertTwoZeroBits(long long int number, int bit1, int bit2)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00045">QuEST_cpu_internal.h:45</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu__internal_8h_html_ab5666cbb8f1de8fe9864c0f3fcc8a3ec"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#ab5666cbb8f1de8fe9864c0f3fcc8a3ec">flipBit</a></div><div class="ttdeci">long long int flipBit(long long int number, int bitInd)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00026">QuEST_cpu_internal.h:26</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ce2c2fd54df25495e99dc5b95bed4b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ce2c2fd54df25495e99dc5b95bed4b2">&#9670;&nbsp;</a></span>statevec_unitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_unitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>unitary matrix to apply </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02059">2059</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00064">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00063">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00865">statevec_unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;{</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot1Real=rot1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot2Real=rot2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="preprocessor">            rot1Real, rot1Imag, rot2Real, rot2Imag) \</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    {</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;            <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;            stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp </div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                + rot2Real*stateRealLo - rot2Imag*stateImagLo;</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp </div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                + rot2Real*stateImagLo + rot2Imag*stateRealLo;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        }</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    }</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;}</div><div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00063">QuEST.h:63</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00064">QuEST.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f62ff38deae8ef012024d416d749c00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f62ff38deae8ef012024d416d749c00">&#9670;&nbsp;</a></span>statevec_unitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_unitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01935">1935</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00072">ComplexMatrix2::imag</a>, <a class="el" href="QuEST_8h_source.html#l00112">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00071">ComplexMatrix2::real</a>, and <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__internal_8h_source.html#l00045">insertTwoZeroBits()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00865">statevec_unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;{</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    {</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;            stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;            stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;            stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;            <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;            stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateImagUp </div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateImagLo;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateRealUp </div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateRealLo;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateImagUp </div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateImagLo;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;            stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateRealUp </div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateRealLo;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        } </div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    }</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;} </div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a3ea98d545b67a190ee6abe936c72076f"><div class="ttname"><a href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">ComplexMatrix2::real</a></div><div class="ttdeci">qreal real[2][2]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00071">QuEST.h:71</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structComplexMatrix2_html_a3a2b60a9e00ccef054a6de3b9307c1be"><div class="ttname"><a href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">ComplexMatrix2::imag</a></div><div class="ttdeci">qreal imag[2][2]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00072">QuEST.h:72</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00112">QuEST.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6d360ce0606d16e3757ab38715c6614"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6d360ce0606d16e3757ab38715c6614">&#9670;&nbsp;</a></span>syncDiagonalOperator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void syncDiagonalOperator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOperator.html">DiagonalOperator</a>&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Syncs the .real and .imag components of <code>op</code> to GPU memory, where it persists until being sync'd again, or destroyed. </p>
<p>This effectively copies <code>op.real</code> and <code>op.imag</code> to <code>op.deviceOperator</code>, though the latter should not be accessed directly since it sits in VRAM. This function has no effect when called in CPU mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">op</td><td>an instantiated operator created with createDiagonalOperator </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00062">62</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                               {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// nothing to do on CPU</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ac5168399122f7f53977dcc9ceda4f458"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5168399122f7f53977dcc9ceda4f458">&#9670;&nbsp;</a></span>zeroSomeAmps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zeroSomeAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00798">798</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00121">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00818">alternateNormZeroingSomeAmpBlocks()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00849">densmatr_collapseToKnownProbOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                                                              {</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor"># pragma omp parallel for schedule (static)</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">for</span> (i=startInd; i &lt; startInd+numAmps; i++) {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] = 0;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i] = 0;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00121">QuEST.h:121</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Sep 28 2019 17:53:57 for Quantum Exact Simulation Toolkit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
